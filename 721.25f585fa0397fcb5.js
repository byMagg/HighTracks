"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[721],{76:(D,J,h)=>{h.d(J,{GW:()=>P,dk:()=>x,oK:()=>u});var u=(()=>{return(C=u||(u={})).Prompt="PROMPT",C.Camera="CAMERA",C.Photos="PHOTOS",u;var C})(),P=(()=>{return(C=P||(P={})).Rear="REAR",C.Front="FRONT",P;var C})(),x=(()=>{return(C=x||(x={})).Uri="uri",C.Base64="base64",C.DataUrl="dataUrl",x;var C})()},7423:(D,J,h)=>{h.d(J,{Uw:()=>v,fo:()=>_,xz:()=>N});var u=h(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var O=(()=>{return(s=O||(O={})).Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE",O;var s})();class N extends Error{constructor(n,i,g){super(n),this.message=n,this.code=i,this.data=g}}const t=s=>{var n,i,g,p,l;const T=s.CapacitorCustomPlatform||null,d=s.Capacitor||{},y=d.Plugins=d.Plugins||{},o=s.CapacitorPlatforms,e=(null===(n=null==o?void 0:o.currentPlatform)||void 0===n?void 0:n.getPlatform)||(()=>null!==T?T.name:(s=>{var n,i;return null!=s&&s.androidBridge?"android":null!==(i=null===(n=null==s?void 0:s.webkit)||void 0===n?void 0:n.messageHandlers)&&void 0!==i&&i.bridge?"ios":"web"})(s)),a=(null===(i=null==o?void 0:o.currentPlatform)||void 0===i?void 0:i.isNativePlatform)||(()=>"web"!==e()),E=(null===(g=null==o?void 0:o.currentPlatform)||void 0===g?void 0:g.isPluginAvailable)||(w=>{const Z=st.get(w);return!!(null!=Z&&Z.platforms.has(e())||z(w))}),z=(null===(p=null==o?void 0:o.currentPlatform)||void 0===p?void 0:p.getPluginHeader)||(w=>{var Z;return null===(Z=d.PluginHeaders)||void 0===Z?void 0:Z.find(q=>q.name===w)}),st=new Map,pt=(null===(l=null==o?void 0:o.currentPlatform)||void 0===l?void 0:l.registerPlugin)||((w,Z={})=>{const q=st.get(w);if(q)return console.warn(`Capacitor plugin "${w}" already registered. Cannot register plugins twice.`),q.proxy;const j=e(),Y=z(w);let B;const bt=function(){var M=(0,u.Z)(function*(){return!B&&j in Z?B=B="function"==typeof Z[j]?yield Z[j]():Z[j]:null!==T&&!B&&"web"in Z&&(B=B="function"==typeof Z.web?yield Z.web():Z.web),B});return function(){return M.apply(this,arguments)}}(),ct=M=>{let U;const L=(...G)=>{const H=bt().then($=>{const Q=((M,U)=>{var L,G;if(!Y){if(M)return null===(G=M[U])||void 0===G?void 0:G.bind(M);throw new N(`"${w}" plugin is not implemented on ${j}`,O.Unimplemented)}{const H=null==Y?void 0:Y.methods.find($=>U===$.name);if(H)return"promise"===H.rtype?$=>d.nativePromise(w,U.toString(),$):($,Q)=>d.nativeCallback(w,U.toString(),$,Q);if(M)return null===(L=M[U])||void 0===L?void 0:L.bind(M)}})($,M);if(Q){const tt=Q(...G);return U=null==tt?void 0:tt.remove,tt}throw new N(`"${w}.${M}()" is not implemented on ${j}`,O.Unimplemented)});return"addListener"===M&&(H.remove=(0,u.Z)(function*(){return U()})),H};return L.toString=()=>`${M.toString()}() { [capacitor code] }`,Object.defineProperty(L,"name",{value:M,writable:!1,configurable:!1}),L},gt=ct("addListener"),ft=ct("removeListener"),vt=(M,U)=>{const L=gt({eventName:M},U),G=function(){var $=(0,u.Z)(function*(){const Q=yield L;ft({eventName:M,callbackId:Q},U)});return function(){return $.apply(this,arguments)}}(),H=new Promise($=>L.then(()=>$({remove:G})));return H.remove=(0,u.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield G()}),H},lt=new Proxy({},{get(M,U){switch(U){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Y?vt:gt;case"removeListener":return ft;default:return ct(U)}}});return y[w]=lt,st.set(w,{name:w,proxy:lt,platforms:new Set([...Object.keys(Z),...Y?[j]:[]])}),lt});return d.convertFileSrc||(d.convertFileSrc=w=>w),d.getPlatform=e,d.handleError=w=>s.console.error(w),d.isNativePlatform=a,d.isPluginAvailable=E,d.pluginMethodNoop=(w,Z,q)=>Promise.reject(`${q} does not have an implementation of "${Z}".`),d.registerPlugin=pt,d.Exception=N,d.DEBUG=!!d.DEBUG,d.isLoggingEnabled=!!d.isLoggingEnabled,d.platform=d.getPlatform(),d.isNative=d.isNativePlatform(),d},I=(s=>s.Capacitor=t(s))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),_=I.registerPlugin;class v{constructor(n){this.listeners={},this.windowListeners={},n&&(console.warn(`Capacitor WebPlugin "${n.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=n)}addListener(n,i){var g=this;this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push(i);const l=this.windowListeners[n];l&&!l.registered&&this.addWindowListener(l);const T=function(){var y=(0,u.Z)(function*(){return g.removeListener(n,i)});return function(){return y.apply(this,arguments)}}(),d=Promise.resolve({remove:T});return Object.defineProperty(d,"remove",{value:(y=(0,u.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield T()}),function(){return y.apply(this,arguments)})}),d;var y}removeAllListeners(){var n=this;return(0,u.Z)(function*(){n.listeners={};for(const i in n.windowListeners)n.removeWindowListener(n.windowListeners[i]);n.windowListeners={}})()}notifyListeners(n,i){const g=this.listeners[n];g&&g.forEach(p=>p(i))}hasListeners(n){return!!this.listeners[n].length}registerWindowListener(n,i){this.windowListeners[i]={registered:!1,windowEventName:n,pluginEventName:i,handler:g=>{this.notifyListeners(i,g)}}}unimplemented(n="not implemented"){return new I.Exception(n,O.Unimplemented)}unavailable(n="not available"){return new I.Exception(n,O.Unavailable)}removeListener(n,i){var g=this;return(0,u.Z)(function*(){const p=g.listeners[n];if(!p)return;const l=p.indexOf(i);g.listeners[n].splice(l,1),g.listeners[n].length||g.removeWindowListener(g.windowListeners[n])})()}addWindowListener(n){window.addEventListener(n.windowEventName,n.handler),n.registered=!0}removeWindowListener(n){n&&(window.removeEventListener(n.windowEventName,n.handler),n.registered=!1)}}const V=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),X=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class et extends v{getCookies(){return(0,u.Z)(function*(){const n=document.cookie,i={};return n.split(";").forEach(g=>{if(g.length<=0)return;let[p,l]=g.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");p=X(p).trim(),l=X(l).trim(),i[p]=l}),i})()}setCookie(n){return(0,u.Z)(function*(){try{const i=V(n.key),g=V(n.value),p=`; expires=${(n.expires||"").replace("expires=","")}`,l=(n.path||"/").replace("path=",""),T=null!=n.url&&n.url.length>0?`domain=${n.url}`:"";document.cookie=`${i}=${g||""}${p}; path=${l}; ${T};`}catch(i){return Promise.reject(i)}})()}deleteCookie(n){return(0,u.Z)(function*(){try{document.cookie=`${n.key}=; Max-Age=0`}catch(i){return Promise.reject(i)}})()}clearCookies(){return(0,u.Z)(function*(){try{const n=document.cookie.split(";")||[];for(const i of n)document.cookie=i.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(n){return Promise.reject(n)}})()}clearAllCookies(){var n=this;return(0,u.Z)(function*(){try{yield n.clearCookies()}catch(i){return Promise.reject(i)}})()}}_("CapacitorCookies",{web:()=>new et});const nt=function(){var s=(0,u.Z)(function*(n){return new Promise((i,g)=>{const p=new FileReader;p.onload=()=>{const l=p.result;i(l.indexOf(",")>=0?l.split(",")[1]:l)},p.onerror=l=>g(l),p.readAsDataURL(n)})});return function(i){return s.apply(this,arguments)}}();class at extends v{request(n){return(0,u.Z)(function*(){const i=((s,n={})=>{const i=Object.assign({method:s.method||"GET",headers:s.headers},n),p=((s={})=>{const n=Object.keys(s);return Object.keys(s).map(p=>p.toLocaleLowerCase()).reduce((p,l,T)=>(p[l]=s[n[T]],p),{})})(s.headers)["content-type"]||"";if("string"==typeof s.data)i.body=s.data;else if(p.includes("application/x-www-form-urlencoded")){const l=new URLSearchParams;for(const[T,d]of Object.entries(s.data||{}))l.set(T,d);i.body=l.toString()}else if(p.includes("multipart/form-data")){const l=new FormData;if(s.data instanceof FormData)s.data.forEach((d,y)=>{l.append(y,d)});else for(const d of Object.keys(s.data))l.append(d,s.data[d]);i.body=l;const T=new Headers(i.headers);T.delete("content-type"),i.headers=T}else(p.includes("application/json")||"object"==typeof s.data)&&(i.body=JSON.stringify(s.data));return i})(n,n.webFetchExtra),g=((s,n=!0)=>s?Object.entries(s).reduce((g,p)=>{const[l,T]=p;let d,y;return Array.isArray(T)?(y="",T.forEach(o=>{d=n?encodeURIComponent(o):o,y+=`${l}=${d}&`}),y.slice(0,-1)):(d=n?encodeURIComponent(T):T,y=`${l}=${d}`),`${g}&${y}`},"").substr(1):null)(n.params,n.shouldEncodeUrlParams),p=g?`${n.url}?${g}`:n.url,l=yield fetch(p,i),T=l.headers.get("content-type")||"";let y,o,{responseType:d="text"}=l.ok?n:{};switch(T.includes("application/json")&&(d="json"),d){case"arraybuffer":case"blob":o=yield l.blob(),y=yield nt(o);break;case"json":y=yield l.json();break;default:y=yield l.text()}const b={};return l.headers.forEach((e,r)=>{b[r]=e}),{data:y,headers:b,status:l.status,url:l.url}})()}get(n){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},n),{method:"GET"}))})()}post(n){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},n),{method:"POST"}))})()}put(n){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},n),{method:"PUT"}))})()}patch(n){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},n),{method:"PATCH"}))})()}delete(n){var i=this;return(0,u.Z)(function*(){return i.request(Object.assign(Object.assign({},n),{method:"DELETE"}))})()}}_("CapacitorHttp",{web:()=>new at})},9425:(D,J,h)=>{h.d(J,{a:()=>d,H:()=>y});var u=h(5861),P=h(6895),x=h(433),C=h(1194),k=h(650);class S{constructor(b,e,r){this._id=b,r&&(this._id=r),this.name=b,this.album=e}}class W{constructor(b,e,r){this.name=e,this.artists=[{name:b}],this.images=[{url:r}]}}var O=h(7423),N=h(76);const K=(0,O.fo)("Camera",{web:()=>h.e(3954).then(h.bind(h,3954)).then(o=>new o.CameraWeb)});var t=h(4650),A=h(8672),I=h(7556);function _(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-segment-button",18),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.changeParams())}),t._uU(1),t.qZA()}if(2&o){const e=b.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function c(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-segment",16),t.NdJ("ngModelChange",function(a){t.CHM(e);const m=t.oxw();return t.KtG(m.filter=a)}),t.YNc(1,_,2,2,"ion-segment-button",17),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("ngModel",e.filter),t.xp6(1),t.Q6J("ngForOf",e.searchFilters)}}function f(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.toggleInsertTrack())}),t._UZ(1,"ion-icon",24),t.qZA()}}function v(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.toggleInsertTrack())}),t._UZ(1,"ion-icon",25),t.qZA()}}function F(o,b){if(1&o&&(t.TgZ(0,"ion-buttons",19),t.YNc(1,f,2,0,"ion-fab-button",20),t.YNc(2,v,2,0,"ion-fab-button",20),t.TgZ(3,"ion-fab-button",21),t._UZ(4,"ion-icon",22),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.toggleInsert),t.xp6(1),t.Q6J("ngIf",e.toggleInsert)}}function V(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",26),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.insertTracks())}),t._UZ(1,"ion-icon",27),t._uU(2),t.qZA()}if(2&o){const e=t.oxw();t.xp6(2),t.hij(" A\xf1adir ",e.tracksToBeAdded.length," canciones ")}}function X(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label",30),t._uU(2,"URL imagen"),t.qZA(),t.TgZ(3,"ion-input",37),t.NdJ("ngModelChange",function(a){t.CHM(e);const m=t.oxw(2);return t.KtG(m.trackToAdd.album.images[0].url=a)}),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngModel",e.trackToAdd.album.images[0].url)}}function et(o,b){1&o&&t._UZ(0,"ion-img",43)}function dt(o,b){if(1&o&&t._UZ(0,"ion-img",14),2&o){const e=t.oxw(3);t.Q6J("src","data:image/jpeg;base64,"+e.trackToAdd.album.images[0].imageBase64String)}}function nt(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"div",38),t.YNc(1,et,1,0,"ion-img",39),t.YNc(2,dt,1,1,"ion-img",40),t.TgZ(3,"ion-fab",41)(4,"ion-fab-button",6),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.takePicture())}),t._UZ(5,"ion-icon",42),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.trackToAdd.album.images[0].imageBase64String),t.xp6(1),t.Q6J("ngIf",e.trackToAdd.album.images[0].imageBase64String)}}function rt(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"A\xf1adir canci\xf3n"),t.qZA(),t.TgZ(4,"ion-buttons",19)(5,"ion-button",6),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.cancel())}),t._uU(6,"Cancelar"),t.qZA(),t.TgZ(7,"ion-button",28),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.confirm(a.trackToAdd))}),t._uU(8,"A\xf1adir"),t.qZA()()()(),t.TgZ(9,"ion-content",29)(10,"ion-item")(11,"ion-label",30),t._uU(12,"Nombre"),t.qZA(),t.TgZ(13,"ion-input",31),t.NdJ("ngModelChange",function(a){t.CHM(e);const m=t.oxw();return t.KtG(m.trackToAdd.name=a)}),t.qZA()(),t.TgZ(14,"ion-item")(15,"ion-label",30),t._uU(16,"Artista/Grupo"),t.qZA(),t.TgZ(17,"ion-input",32),t.NdJ("ngModelChange",function(a){t.CHM(e);const m=t.oxw();return t.KtG(m.trackToAdd.album.artists[0].name=a)}),t.qZA()(),t.TgZ(18,"ion-segment",16),t.NdJ("ngModelChange",function(a){t.CHM(e);const m=t.oxw();return t.KtG(m.togglePhoto=a)}),t.TgZ(19,"ion-segment-button",33)(20,"ion-label"),t._uU(21,"URL"),t.qZA()(),t.TgZ(22,"ion-segment-button",34)(23,"ion-label"),t._uU(24,"Imagen"),t.qZA()()(),t.YNc(25,X,4,1,"ion-item",35),t.YNc(26,nt,6,2,"div",36),t.qZA()}if(2&o){const e=t.oxw();t.xp6(7),t.Q6J("strong",!0),t.xp6(6),t.Q6J("ngModel",e.trackToAdd.name),t.xp6(4),t.Q6J("ngModel",e.trackToAdd.album.artists[0].name),t.xp6(1),t.Q6J("ngModel",e.togglePhoto),t.xp6(7),t.Q6J("ngIf","url"===e.togglePhoto),t.xp6(1),t.Q6J("ngIf","img"===e.togglePhoto)}}function ot(o,b){1&o&&t._UZ(0,"ion-icon",55)}function it(o,b){1&o&&t._UZ(0,"ion-icon",56)}function at(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",52),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,m=t.oxw(),E=t.MAs(22);return t.KtG(E.src!=a.preview_url?m.changePreview(E,a.preview_url):m.changePreview(E))}),t.YNc(1,ot,1,0,"ion-icon",53),t.YNc(2,it,1,0,"ion-icon",54),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.oxw();const r=t.MAs(22);t.xp6(1),t.Q6J("ngIf",r.src!=e.preview_url),t.xp6(1),t.Q6J("ngIf",r.src==e.preview_url)}}function ut(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,m=t.oxw();return t.KtG(m.tracksToBeAdded.push(a)&&m.test())}),t._UZ(1,"ion-icon",22),t.qZA()}}function s(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-button",57),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,m=t.oxw();return t.KtG(m.tracksToBeAdded.splice(m.tracksToBeAdded.indexOf(a),1)&&m.test())}),t._UZ(1,"ion-icon",58),t.qZA()}}function n(o,b){1&o&&(t.TgZ(0,"ion-fab-button",59),t._UZ(1,"ion-icon",60),t.qZA())}function i(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-fab-list")(1,"ion-fab-button")(2,"ion-icon",61),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,m=t.oxw();return t.KtG(m.navigateToTrackEdit(a._id))}),t.qZA()(),t.TgZ(3,"ion-fab-button",62),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,m=t.oxw();return t.KtG(m.handleDeleteAlert(a._id))}),t._UZ(4,"ion-icon",63),t.qZA()()}}function g(o,b){if(1&o&&t._UZ(0,"ion-img",14),2&o){const e=t.oxw().$implicit;t.s9C("src",e.album.images[0].url)}}function p(o,b){if(1&o&&t._UZ(0,"ion-img",14),2&o){const e=t.oxw().$implicit;t.Q6J("src","data:image/jpeg;base64,"+e.album.images[0].imageBase64String)}}function l(o,b){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=b.$implicit;t.xp6(1),t.Oqu(e.name)}}function T(o,b){if(1&o){const e=t.EpF();t.TgZ(0,"ion-card",44),t.YNc(1,at,3,2,"ion-fab-button",45),t.TgZ(2,"ion-fab"),t.YNc(3,ut,2,0,"ion-fab-button",20),t.YNc(4,s,2,0,"ion-fab-button",46),t.YNc(5,n,2,0,"ion-fab-button",47),t.YNc(6,i,5,0,"ion-fab-list",35),t.qZA(),t.TgZ(7,"div",48),t.NdJ("click",function(){const m=t.CHM(e).$implicit,E=t.oxw();return t.KtG(!E.toggleInsert&&E.navigateToTrack(m._id))}),t.TgZ(8,"div",49),t.YNc(9,g,1,1,"ion-img",40),t.YNc(10,p,1,1,"ion-img",40),t.qZA(),t.TgZ(11,"div",50)(12,"div")(13,"p"),t._uU(14),t.qZA()(),t.TgZ(15,"div"),t.YNc(16,l,2,1,"p",51),t.qZA(),t.TgZ(17,"div")(18,"p"),t._uU(19),t.ALo(20,"date"),t.qZA()()()()()}if(2&o){const e=b.$implicit,r=t.oxw();t.xp6(1),t.Q6J("ngIf",e.preview_url),t.xp6(2),t.Q6J("ngIf",r.toggleInsert&&!r.tracksToBeAdded.includes(e)),t.xp6(1),t.Q6J("ngIf",r.toggleInsert&&r.tracksToBeAdded.includes(e)),t.xp6(1),t.Q6J("ngIf",!r.toggleInsert&&r.displayInsert),t.xp6(1),t.Q6J("ngIf",!r.toggleInsert&&r.displayInsert),t.xp6(3),t.Q6J("ngIf",e.album.images[0].url),t.xp6(1),t.Q6J("ngIf",e.album.images[0].imageBase64String),t.xp6(4),t.Oqu(e.name),t.xp6(2),t.Q6J("ngForOf",e.album.artists),t.xp6(3),t.hij("",t.xi3(20,10,e.duration_ms,"mm:ss")," min")}}var d=(()=>{return(o=d||(d={})).name="name",o.artist="artist",o.date="date",d;var o})();let y=(()=>{class o{constructor(e,r,a,m,E,R){this.apiService=e,this.route=r,this.authService=a,this.router=m,this.alertCtrl=E,this.toastCtrl=R,this.toggleInsert=!1,this.displayInsert=!1,this.filter=d.name,this.searchFilters=Object.values(d),this.trackToAdd=new S("",new W("","","")),this.togglePhoto="url",this.tracksToBeAdded=[],this.route.queryParams.subscribe(z=>{this.displayInsert=this.authService.checkLogged(),this.query=z.s,Object.keys(d).includes(z.f)&&(this.filter=z.f),this.search()})}changePreview(e,r){r?e.src=r:(e.src="",e.removeAttribute("src")),e.play()}handleDeleteAlert(e){this.alertCtrl.create({header:"Confirmar eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que quieres eliminar esta canci\xf3n?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"confirm",handler:()=>{var r;this.deleteTrack(e),this.tracks=null===(r=this.tracks)||void 0===r?void 0:r.filter(a=>a._id!=e)}}]}).then(r=>r.present())}test(){console.log(this.tracksToBeAdded)}cancel(){this.modal&&this.modal.dismiss(null,"cancel")}confirm(e){this.modal&&this.modal.dismiss(e,"confirm")}onWillDismiss(e){const r=e;var a;console.log("Will dismiss with: ",r.detail),"confirm"===r.detail.role&&r.detail.data&&(r.detail.data._id=null===(a=r.detail.data)||void 0===a?void 0:a.name,"url"==this.togglePhoto&&(r.detail.data.album.images[0].imageBase64String=void 0),"img"==this.togglePhoto&&(r.detail.data.album.images[0].url=void 0),this.insertTrack(r.detail.data))}changeParams(){let e={s:this.query,f:this.filter};""==this.query&&(e.s=void 0),this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge"})}navigateToTrack(e){this.router.navigate([`/tracks/${e}`])}navigateToTrackEdit(e){this.router.navigate([`/tracks/${e}/edit`])}toggleInsertTrack(){this.toggleInsert=!this.toggleInsert,this.search()}search(){this.changeParams(),this.query?this.toggleInsert?this.searchSpotify(this.query):this.searchDB(this.query):this.toggleInsert?this.tracks=[]:this.getAllTracks()}searchSpotify(e){var r=this;return(0,u.Z)(function*(){const a=yield r.apiService.searchTracksSpotify(e),m=yield r.apiService.getTracks();for(let E of a)E.inserted=!!m.find(R=>R._id==E._id);r.tracks=a.filter(E=>0==E.inserted)})()}searchDB(e){var r=this;return(0,u.Z)(function*(){try{r.tracks=yield r.apiService.searchTracks(e,r.filter)}catch(a){a instanceof Error&&console.error(a.message)}})()}getAllTracks(){var e=this;return(0,u.Z)(function*(){try{e.tracks=yield e.apiService.getTracks()}catch(r){r instanceof Error&&console.error(r.message)}})()}insertTrack(e){var r=this;return(0,u.Z)(function*(){var a;yield r.apiService.insertTrack(e),r.tracks=null===(a=r.tracks)||void 0===a?void 0:a.filter(m=>m._id!=e._id),r.toastCtrl.create({message:"Canci\xf3n insertada correctamente",duration:2e3}).then(m=>m.present()),r.search()})()}insertTracks(){var e=this;return(0,u.Z)(function*(){0!=e.tracksToBeAdded.length&&(yield e.apiService.insertTracks(e.tracksToBeAdded),e.tracksToBeAdded=[],e.toastCtrl.create({message:"Canciones insertadas correctamente",duration:2e3}).then(r=>r.present()),e.query="",e.toggleInsertTrack())})()}deleteTrack(e){var r=this;return(0,u.Z)(function*(){console.log("deleteTrack: "+e),(yield r.apiService.deleteTrack(e))?r.toastCtrl.create({message:"Canci\xf3n eliminada correctamente",duration:2e3}).then(m=>m.present()):r.toastCtrl.create({message:"No se ha podido eliminar la canci\xf3n",duration:2e3}).then(m=>m.present())})()}takePicture(){var e=this;return(0,u.Z)(function*(){const r=yield K.getPhoto({quality:100,allowEditing:!1,resultType:N.dk.Base64});r&&r.base64String&&(e.trackToAdd.album.images[0]={imageBase64String:r.base64String})})()}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.j),t.Y36(C.gz),t.Y36(I.e),t.Y36(C.F0),t.Y36(k.Br),t.Y36(k.yF))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-tracks"]],viewQuery:function(e,r){if(1&e&&t.Gf(k.ki,5),2&e){let a;t.iGM(a=t.CRH())&&(r.modal=a.first)}},standalone:!0,features:[t.jDz],decls:23,vars:7,consts:[["slot","start"],["defaultHref","/"],[3,"ngModel","ngModelChange",4,"ngIf"],["slot","end",4,"ngIf"],["id","searchBar"],["mode","ios","placeholder","Introduce el nombre de la canci\xf3n",3,"ngModel","keyup.enter","ngModelChange"],[3,"click"],["slot","end","name","search"],["id","addTracks","color","success","shape","round",3,"click",4,"ngIf"],["id","container"],["trigger","open-modal",3,"willDismiss"],[3,"fixed"],[1,"ion-justify-content-center"],["button","","class","card",4,"ngFor","ngForOf"],[3,"src"],["ref",""],[3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["slot","end"],["size","small",3,"click",4,"ngIf"],["id","open-modal","size","small"],["name","add"],["size","small",3,"click"],["name","search"],["name","list"],["id","addTracks","color","success","shape","round",3,"click"],["name","checkmark"],["color","primary",3,"strong","click"],[1,"ion-padding"],["position","stacked"],["type","text","aria-label","Nombre","placeholder","Nombre de la canci\xf3n",3,"ngModel","ngModelChange"],["type","text","aria-label","Artista","placeholder","Artista o grupo",3,"ngModel","ngModelChange"],["value","url"],["value","img"],[4,"ngIf"],["style","padding: 45px 0;",4,"ngIf"],["type","text","aria-label","URL","placeholder","URL de la imagen",3,"ngModel","ngModelChange"],[2,"padding","45px 0"],["src","../../../assets/placeholder.png",4,"ngIf"],[3,"src",4,"ngIf"],["vertical","bottom","horizontal","center","slot","fixed"],["name","camera"],["src","../../../assets/placeholder.png"],["button","",1,"card"],["size","small","class","playButton",3,"click",4,"ngIf"],["color","danger","size","small",3,"click",4,"ngIf"],["size","small","color","light",4,"ngIf"],[1,"card",3,"click"],["id","img-container"],["id","card-info"],[4,"ngFor","ngForOf"],["size","small",1,"playButton",3,"click"],["name","play",4,"ngIf"],["name","pause",4,"ngIf"],["name","play"],["name","pause"],["color","danger","size","small",3,"click"],["name","close"],["size","small","color","light"],["name","ellipsis-vertical"],["name","pencil",3,"click"],["id","delete-alert",3,"click"],["name","trash","color","danger"]],template:function(e,r){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t.YNc(5,c,2,2,"ion-segment",2),t.qZA(),t.YNc(6,F,5,2,"ion-buttons",3),t.qZA(),t.TgZ(7,"ion-toolbar")(8,"div",4)(9,"ion-searchbar",5),t.NdJ("keyup.enter",function(){return r.search()})("ngModelChange",function(m){return r.query=m}),t.qZA(),t.TgZ(10,"ion-button",6),t.NdJ("click",function(){return r.search()}),t._UZ(11,"ion-icon",7),t._uU(12," Buscar "),t.qZA()()(),t.YNc(13,V,3,1,"ion-button",8),t.qZA(),t.TgZ(14,"ion-content")(15,"div",9)(16,"ion-modal",10),t.NdJ("willDismiss",function(m){return r.onWillDismiss(m)}),t.YNc(17,rt,27,6,"ng-template"),t.qZA(),t.TgZ(18,"ion-grid",11)(19,"ion-row",12),t.YNc(20,T,21,13,"ion-card",13),t.qZA()()(),t._UZ(21,"audio",14,15),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngIf",!r.toggleInsert),t.xp6(1),t.Q6J("ngIf",r.displayInsert),t.xp6(3),t.Q6J("ngModel",r.query),t.xp6(4),t.Q6J("ngIf",r.toggleInsert&&0!=r.tracksToBeAdded.length),t.xp6(5),t.Q6J("fixed",!0),t.xp6(2),t.Q6J("ngForOf",r.tracks),t.xp6(1),t.Q6J("src",r.previewToPlay,t.LSH))},dependencies:[P.ez,P.sg,P.O5,P.uU,x.u5,x.JJ,x.On,k.Pc,k.oU,k.YG,k.Sm,k.PM,k.W2,k.IJ,k.W4,k.zq,k.jY,k.Gu,k.gu,k.Xz,k.pK,k.Ie,k.Q$,k.Nd,k.VI,k.cJ,k.GO,k.wd,k.sr,k.ki,k.QI,k.j9,k.cs,C.Bz],styles:['ion-card[_ngcontent-%COMP%]{width:200px;position:relative;height:300px;background-color:#000;transition:.5s}ion-card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}ion-img[_ngcontent-%COMP%]{height:100%}ion-card[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{position:absolute;z-index:1;top:0;right:0}#img-container[_ngcontent-%COMP%]{position:relative}#img-container[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;top:0;width:100%;height:100%;background:linear-gradient(to bottom,rgba(255,255,255,0) 0,black 100%)}#card-info[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}#card-info[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#000;color:#fff;text-align:center;border-radius:5px;margin:0 auto;width:max-content;padding:0 10px;max-width:80%;box-shadow:0 0 130px 30px var(--ion-color-primary)}#searchBar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:500px;margin:0 auto}#searchBar[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:0 20px}ion-segment[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin:0 auto}ion-modal[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:45%;margin:0 auto}#addTracks[_ngcontent-%COMP%]{position:fixed;top:62px;right:20px;z-index:10}.playButton[_ngcontent-%COMP%]{position:absolute;z-index:100;opacity:0;transition:opacity .3s ease-in-out}.card[_ngcontent-%COMP%]:hover   .playButton[_ngcontent-%COMP%]{opacity:1}@media (max-width: 1075px){#addTracks[_ngcontent-%COMP%]{bottom:50px;right:50px;top:unset}}@media (max-width: 768px){ion-modal[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:90%;margin:0 auto}}@media (max-width: 768px) and (max-width: 425px){ion-card[_ngcontent-%COMP%]{width:150px;height:245px}}@media (max-width: 768px) and (max-width: 425px) and (max-width: 350px){ion-card[_ngcontent-%COMP%]{width:90%;height:215px}}']}),o})()},721:(D,J,h)=>{h.r(J),h.d(J,{routes:()=>P});const P=[{path:"",component:h(9425).H},{path:":id",loadComponent:()=>h.e(6845).then(h.bind(h,6845)).then(x=>x.TrackPage)},{path:":id/edit",loadComponent:()=>h.e(9077).then(h.bind(h,9077)).then(x=>x.EditPage)}]},8672:(D,J,h)=>{h.d(J,{j:()=>t});var u=h(5861),P=h(529),x=h(9808),C=h(2340),k=h(9425),S=h(4650),W=h(7556);const N=(0,h(7423).fo)("Geolocation",{web:()=>h.e(4561).then(h.bind(h,4561)).then(A=>new A.GeolocationWeb)});let K=(()=>{class A{constructor(){this.coords={latitude:0,longitude:0,accuracy:0}}getLocation(){var _=this;return(0,u.Z)(function*(){const c=yield N.getCurrentPosition();return _.coords.latitude=c.coords.latitude,_.coords.latitude=c.coords.longitude,_.coords.accuracy=c.coords.accuracy,_.coords})()}}return A.\u0275fac=function(_){return new(_||A)},A.\u0275prov=S.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})(),t=(()=>{class A{constructor(_,c,f){this.http=_,this.authService=c,this.geoService=f,this.url=C.N.url,this.token=this.authService.getJWT()}searchTracksSpotify(_){var c=this;return(0,u.Z)(function*(){try{const f=(yield(0,x.n)(c.http.get(`${c.url}search/${encodeURI(_)}`))).tracks.items;return console.log(f),f.map(v=>({_id:v.id,...v,id:void 0}))}catch(f){return console.log(f),[]}})()}searchTracks(_,c=k.a.name){var f=this;return(0,u.Z)(function*(){try{return yield(0,x.n)(f.http.get(`${f.url}tracks/search?${c}=${encodeURI(_)}`,{headers:{Authorization:`Bearer ${f.token}`}}))}catch(v){if(v instanceof P.UA){if(404===v.status)throw new Error("Track not found");if(500===v.status)throw new Error("Error getting track");if(0===v.status)throw new Error("Error connecting to server")}throw v}})()}getTrack(_){var c=this;return(0,u.Z)(function*(){try{return yield(0,x.n)(c.http.get(`${c.url}tracks/${_}`,{headers:{Authorization:`Bearer ${c.token}`}}))}catch(f){if(f instanceof P.UA){if(404===f.status)throw new Error("Track not found");if(500===f.status)throw new Error("Error getting track");if(0===f.status)throw new Error("Error connecting to server")}throw f}})()}getTracks(){var _=this;return(0,u.Z)(function*(){try{return yield(0,x.n)(_.http.get(`${_.url}tracks/`,{headers:{Authorization:`Bearer ${_.token}`}}))}catch(c){if(c instanceof P.UA){if(500===c.status)throw new Error("Error getting track");if(0===c.status)throw new Error("Error connecting to server")}}return[]})()}insertTrack(_){var c=this;return(0,u.Z)(function*(){const f=yield c.geoService.getLocation();_.location=f;const v=[_];try{return yield(0,x.n)(c.http.post(`${c.url}tracks/`,v,{headers:{Authorization:`Bearer ${c.token}`}})),!0}catch(F){if(F instanceof P.UA&&400===F.status)throw Error("Track already exists");return!1}})()}insertTracks(_){var c=this;return(0,u.Z)(function*(){const f=yield c.geoService.getLocation();_.forEach(v=>v.location=f);try{return yield(0,x.n)(c.http.post(`${c.url}tracks/`,_,{headers:{Authorization:`Bearer ${c.token}`}})),!0}catch(v){if(v instanceof P.UA&&400===v.status)throw Error("Track already exists");return!1}})()}insertComment(_,c){var f=this;return(0,u.Z)(function*(){const v=yield f.geoService.getLocation();c.location=v,console.log(c);try{return yield(0,x.n)(f.http.post(`${f.url}tracks/${_}/comments`,c,{headers:{Authorization:`Bearer ${f.token}`}})),!0}catch(F){return F instanceof P.UA&&404===F.status&&console.log("Track not found"),!1}})()}updateTrack(_){var c=this;return(0,u.Z)(function*(){try{return yield(0,x.n)(c.http.put(`${c.url}tracks/${_._id}`,_,{headers:{Authorization:`Bearer ${c.token}`}})),!0}catch(f){return f instanceof P.UA&&(404===f.status&&console.log("Track not found"),500===f.status&&console.log("Error updating track")),!1}})()}deleteTrack(_){var c=this;return(0,u.Z)(function*(){try{return yield(0,x.n)(c.http.delete(`${c.url}tracks/${_}`,{headers:{Authorization:`Bearer ${c.token}`}})),!0}catch(f){return f instanceof P.UA&&(404===f.status&&console.log("Track not found"),500===f.status&&console.log("Error deleting track")),!1}})()}getComments(_){var c=this;return(0,u.Z)(function*(){let f=[];try{f=yield(0,x.n)(c.http.get(`${c.url}tracks/${_}/comments`,{headers:{Authorization:`Bearer ${c.token}`}})),console.log(f)}catch(v){v instanceof P.UA&&(404===v.status&&console.log("Track not found"),500===v.status&&console.log("Error getting comments"))}return f})()}deleteComment(_,c){var f=this;return(0,u.Z)(function*(){try{return yield(0,x.n)(f.http.delete(`${f.url}tracks/${_}/comments/${c}`,{headers:{Authorization:`Bearer ${f.token}`}})),!0}catch(v){return v instanceof P.UA&&(404===v.status&&console.log("Track not found"),500===v.status&&console.log("Error deleting comment")),!1}})()}}return A.\u0275fac=function(_){return new(_||A)(S.LFG(P.eN),S.LFG(W.e),S.LFG(K))},A.\u0275prov=S.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()}}]);