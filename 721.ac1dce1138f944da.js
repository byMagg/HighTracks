"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[721],{7423:(ne,j,f)=>{f.d(j,{Uw:()=>l,fo:()=>k});var h=f(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var M=(()=>{return(i=M||(M={})).Unimplemented="UNIMPLEMENTED",i.Unavailable="UNAVAILABLE",M;var i})();class e extends Error{constructor(t,r,c){super(t),this.message=t,this.code=r,this.data=c}}const R=i=>{var t,r,c,u,a;const b=i.CapacitorCustomPlatform||null,d=i.Capacitor||{},x=d.Plugins=d.Plugins||{},T=i.CapacitorPlatforms,q=(null===(t=null==T?void 0:T.currentPlatform)||void 0===t?void 0:t.getPlatform)||(()=>null!==b?b.name:(i=>{var t,r;return null!=i&&i.androidBridge?"android":null!==(r=null===(t=null==i?void 0:i.webkit)||void 0===t?void 0:t.messageHandlers)&&void 0!==r&&r.bridge?"ios":"web"})(i)),de=(null===(r=null==T?void 0:T.currentPlatform)||void 0===r?void 0:r.isNativePlatform)||(()=>"web"!==q()),ge=(null===(c=null==T?void 0:T.currentPlatform)||void 0===c?void 0:c.isPluginAvailable)||(C=>{const w=oe.get(C);return!!(null!=w&&w.platforms.has(q())||ae(C))}),ae=(null===(u=null==T?void 0:T.currentPlatform)||void 0===u?void 0:u.getPluginHeader)||(C=>{var w;return null===(w=d.PluginHeaders)||void 0===w?void 0:w.find(D=>D.name===C)}),oe=new Map,_e=(null===(a=null==T?void 0:T.currentPlatform)||void 0===a?void 0:a.registerPlugin)||((C,w={})=>{const D=oe.get(C);if(D)return console.warn(`Capacitor plugin "${C}" already registered. Cannot register plugins twice.`),D.proxy;const N=q(),K=ae(C);let S;const ve=function(){var Z=(0,h.Z)(function*(){return!S&&N in w?S=S="function"==typeof w[N]?yield w[N]():w[N]:null!==b&&!S&&"web"in w&&(S=S="function"==typeof w.web?yield w.web():w.web),S});return function(){return Z.apply(this,arguments)}}(),ie=Z=>{let $;const F=(...H)=>{const B=ve().then(E=>{const W=((Z,$)=>{var F,H;if(!K){if(Z)return null===(H=Z[$])||void 0===H?void 0:H.bind(Z);throw new e(`"${C}" plugin is not implemented on ${N}`,M.Unimplemented)}{const B=null==K?void 0:K.methods.find(E=>$===E.name);if(B)return"promise"===B.rtype?E=>d.nativePromise(C,$.toString(),E):(E,W)=>d.nativeCallback(C,$.toString(),E,W);if(Z)return null===(F=Z[$])||void 0===F?void 0:F.bind(Z)}})(E,Z);if(W){const te=W(...H);return $=null==te?void 0:te.remove,te}throw new e(`"${C}.${Z}()" is not implemented on ${N}`,M.Unimplemented)});return"addListener"===Z&&(B.remove=(0,h.Z)(function*(){return $()})),B};return F.toString=()=>`${Z.toString()}() { [capacitor code] }`,Object.defineProperty(F,"name",{value:Z,writable:!1,configurable:!1}),F},ce=ie("addListener"),le=ie("removeListener"),ke=(Z,$)=>{const F=ce({eventName:Z},$),H=function(){var E=(0,h.Z)(function*(){const W=yield F;le({eventName:Z,callbackId:W},$)});return function(){return E.apply(this,arguments)}}(),B=new Promise(E=>F.then(()=>E({remove:H})));return B.remove=(0,h.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield H()}),B},se=new Proxy({},{get(Z,$){switch($){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return K?ke:ce;case"removeListener":return le;default:return ie($)}}});return x[C]=se,oe.set(C,{name:C,proxy:se,platforms:new Set([...Object.keys(w),...K?[N]:[]])}),se});return d.convertFileSrc||(d.convertFileSrc=C=>C),d.getPlatform=q,d.handleError=C=>i.console.error(C),d.isNativePlatform=de,d.isPluginAvailable=ge,d.pluginMethodNoop=(C,w,D)=>Promise.reject(`${D} does not have an implementation of "${w}".`),d.registerPlugin=_e,d.Exception=e,d.DEBUG=!!d.DEBUG,d.isLoggingEnabled=!!d.isLoggingEnabled,d.platform=d.getPlatform(),d.isNative=d.isNativePlatform(),d},G=(i=>i.Capacitor=R(i))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),k=G.registerPlugin;class l{constructor(t){this.listeners={},this.windowListeners={},t&&(console.warn(`Capacitor WebPlugin "${t.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=t)}addListener(t,r){var c=this;this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(r);const a=this.windowListeners[t];a&&!a.registered&&this.addWindowListener(a);const b=function(){var x=(0,h.Z)(function*(){return c.removeListener(t,r)});return function(){return x.apply(this,arguments)}}(),d=Promise.resolve({remove:b});return Object.defineProperty(d,"remove",{value:(x=(0,h.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield b()}),function(){return x.apply(this,arguments)})}),d;var x}removeAllListeners(){var t=this;return(0,h.Z)(function*(){t.listeners={};for(const r in t.windowListeners)t.removeWindowListener(t.windowListeners[r]);t.windowListeners={}})()}notifyListeners(t,r){const c=this.listeners[t];c&&c.forEach(u=>u(r))}hasListeners(t){return!!this.listeners[t].length}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:c=>{this.notifyListeners(r,c)}}}unimplemented(t="not implemented"){return new G.Exception(t,M.Unimplemented)}unavailable(t="not available"){return new G.Exception(t,M.Unavailable)}removeListener(t,r){var c=this;return(0,h.Z)(function*(){const u=c.listeners[t];if(!u)return;const a=u.indexOf(r);c.listeners[t].splice(a,1),c.listeners[t].length||c.removeWindowListener(c.windowListeners[t])})()}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}}const y=i=>encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),O=i=>i.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Y extends l{getCookies(){return(0,h.Z)(function*(){const t=document.cookie,r={};return t.split(";").forEach(c=>{if(c.length<=0)return;let[u,a]=c.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");u=O(u).trim(),a=O(a).trim(),r[u]=a}),r})()}setCookie(t){return(0,h.Z)(function*(){try{const r=y(t.key),c=y(t.value),u=`; expires=${(t.expires||"").replace("expires=","")}`,a=(t.path||"/").replace("path=",""),b=null!=t.url&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${c||""}${u}; path=${a}; ${b};`}catch(r){return Promise.reject(r)}})()}deleteCookie(t){return(0,h.Z)(function*(){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}})()}clearCookies(){return(0,h.Z)(function*(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(t){return Promise.reject(t)}})()}clearAllCookies(){var t=this;return(0,h.Z)(function*(){try{yield t.clearCookies()}catch(r){return Promise.reject(r)}})()}}k("CapacitorCookies",{web:()=>new Y});const P=function(){var i=(0,h.Z)(function*(t){return new Promise((r,c)=>{const u=new FileReader;u.onload=()=>{const a=u.result;r(a.indexOf(",")>=0?a.split(",")[1]:a)},u.onerror=a=>c(a),u.readAsDataURL(t)})});return function(r){return i.apply(this,arguments)}}();class _ extends l{request(t){return(0,h.Z)(function*(){const r=((i,t={})=>{const r=Object.assign({method:i.method||"GET",headers:i.headers},t),u=((i={})=>{const t=Object.keys(i);return Object.keys(i).map(u=>u.toLocaleLowerCase()).reduce((u,a,b)=>(u[a]=i[t[b]],u),{})})(i.headers)["content-type"]||"";if("string"==typeof i.data)r.body=i.data;else if(u.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[b,d]of Object.entries(i.data||{}))a.set(b,d);r.body=a.toString()}else if(u.includes("multipart/form-data")){const a=new FormData;if(i.data instanceof FormData)i.data.forEach((d,x)=>{a.append(x,d)});else for(const d of Object.keys(i.data))a.append(d,i.data[d]);r.body=a;const b=new Headers(r.headers);b.delete("content-type"),r.headers=b}else(u.includes("application/json")||"object"==typeof i.data)&&(r.body=JSON.stringify(i.data));return r})(t,t.webFetchExtra),c=((i,t=!0)=>i?Object.entries(i).reduce((c,u)=>{const[a,b]=u;let d,x;return Array.isArray(b)?(x="",b.forEach(T=>{d=t?encodeURIComponent(T):T,x+=`${a}=${d}&`}),x.slice(0,-1)):(d=t?encodeURIComponent(b):b,x=`${a}=${d}`),`${c}&${x}`},"").substr(1):null)(t.params,t.shouldEncodeUrlParams),u=c?`${t.url}?${c}`:t.url,a=yield fetch(u,r),b=a.headers.get("content-type")||"";let x,T,{responseType:d="text"}=a.ok?t:{};switch(b.includes("application/json")&&(d="json"),d){case"arraybuffer":case"blob":T=yield a.blob(),x=yield P(T);break;case"json":x=yield a.json();break;default:x=yield a.text()}const ee={};return a.headers.forEach((q,re)=>{ee[re]=q}),{data:x,headers:ee,status:a.status,url:a.url}})()}get(t){var r=this;return(0,h.Z)(function*(){return r.request(Object.assign(Object.assign({},t),{method:"GET"}))})()}post(t){var r=this;return(0,h.Z)(function*(){return r.request(Object.assign(Object.assign({},t),{method:"POST"}))})()}put(t){var r=this;return(0,h.Z)(function*(){return r.request(Object.assign(Object.assign({},t),{method:"PUT"}))})()}patch(t){var r=this;return(0,h.Z)(function*(){return r.request(Object.assign(Object.assign({},t),{method:"PATCH"}))})()}delete(t){var r=this;return(0,h.Z)(function*(){return r.request(Object.assign(Object.assign({},t),{method:"DELETE"}))})()}}k("CapacitorHttp",{web:()=>new _})},6097:(ne,j,f)=>{f.d(j,{a:()=>O,H:()=>Y});var h=f(5861),A=f(6895),L=f(433),U=f(1194),p=f(650);class V{constructor(P,n,o){this._id=P,o&&(this._id=o),this.name=P,this.album=n}}var z=f(7556);class M{constructor(P,n,o){this.name=n,this.artists=[{name:P}],this.images=[{url:o}]}}var e=f(4650),Q=f(7542);function R(m,P){if(1&m){const n=e.EpF();e.TgZ(0,"ion-segment-button",18),e.NdJ("click",function(){e.CHM(n);const s=e.oxw(2);return e.KtG(s.changeParams())}),e._uU(1),e.qZA()}if(2&m){const n=P.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n," ")}}function X(m,P){if(1&m){const n=e.EpF();e.TgZ(0,"ion-segment",16),e.NdJ("ngModelChange",function(s){e.CHM(n);const _=e.oxw();return e.KtG(_.filter=s)}),e.YNc(1,R,2,2,"ion-segment-button",17),e.qZA()}if(2&m){const n=e.oxw();e.Q6J("ngModel",n.filter),e.xp6(1),e.Q6J("ngForOf",n.searchFilters)}}function G(m,P){if(1&m){const n=e.EpF();e.TgZ(0,"ion-button",9),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.toggleInsertTrack())}),e._uU(1),e.qZA()}if(2&m){const n=e.oxw();e.xp6(1),e.hij(" ",n.toggleInsert?"Mostrar listado":"Buscar spotify"," ")}}function k(m,P){if(1&m){const n=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"A\xf1adir canci\xf3n"),e.qZA(),e.TgZ(4,"ion-buttons",3)(5,"ion-button",9),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.cancel())}),e._uU(6,"Cancelar"),e.qZA(),e.TgZ(7,"ion-button",19),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.confirm(s.trackToAdd))}),e._uU(8,"A\xf1adir"),e.qZA()()()(),e.TgZ(9,"ion-content",20)(10,"ion-item")(11,"ion-label",21),e._uU(12,"Nombre"),e.qZA(),e.TgZ(13,"ion-input",22),e.NdJ("ngModelChange",function(s){e.CHM(n);const _=e.oxw();return e.KtG(_.trackToAdd.name=s)}),e.qZA()(),e.TgZ(14,"ion-item")(15,"ion-label",21),e._uU(16,"Artista/Grupo"),e.qZA(),e.TgZ(17,"ion-input",23),e.NdJ("ngModelChange",function(s){e.CHM(n);const _=e.oxw();return e.KtG(_.trackToAdd.album.artists[0].name=s)}),e.qZA()(),e.TgZ(18,"ion-item")(19,"ion-label",21),e._uU(20,"URL imagen"),e.qZA(),e.TgZ(21,"ion-input",24),e.NdJ("ngModelChange",function(s){e.CHM(n);const _=e.oxw();return e.KtG(_.trackToAdd.album.images[0].url=s)}),e.qZA()()()}if(2&m){const n=e.oxw();e.xp6(7),e.Q6J("strong",!0),e.xp6(6),e.Q6J("ngModel",n.trackToAdd.name),e.xp6(4),e.Q6J("ngModel",n.trackToAdd.album.artists[0].name),e.xp6(4),e.Q6J("ngModel",n.trackToAdd.album.images[0].url)}}function J(m,P){if(1&m){const n=e.EpF();e.TgZ(0,"ion-fab-button",33),e.NdJ("click",function(){e.CHM(n);const s=e.oxw().$implicit,_=e.oxw();return e.KtG(_.insertTrack(s))}),e._UZ(1,"ion-icon",6),e.qZA()}}function g(m,P){1&m&&(e.TgZ(0,"ion-fab-button",34),e._UZ(1,"ion-icon",35),e.qZA())}function l(m,P){if(1&m){const n=e.EpF();e.TgZ(0,"ion-fab-list")(1,"ion-fab-button")(2,"ion-icon",36),e.NdJ("click",function(){e.CHM(n);const s=e.oxw().$implicit,_=e.oxw();return e.KtG(_.navigateToTrackEdit(s._id))}),e.qZA()(),e.TgZ(3,"ion-fab-button",37),e.NdJ("click",function(){e.CHM(n);const s=e.oxw().$implicit,_=e.oxw();return e.KtG(_.handleDeleteAlert(s._id))}),e._UZ(4,"ion-icon",38),e.qZA()()}}function v(m,P){if(1&m&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&m){const n=P.$implicit;e.xp6(1),e.Oqu(n.name)}}function y(m,P){if(1&m){const n=e.EpF();e.TgZ(0,"ion-card",25)(1,"ion-fab"),e.YNc(2,J,2,0,"ion-fab-button",26),e.YNc(3,g,2,0,"ion-fab-button",27),e.YNc(4,l,5,0,"ion-fab-list",28),e.qZA(),e.TgZ(5,"div",9),e.NdJ("click",function(){const _=e.CHM(n).$implicit,I=e.oxw();return e.KtG(I.navigateToTrack(_._id))}),e.TgZ(6,"div",29),e._UZ(7,"ion-img",30),e.qZA(),e.TgZ(8,"div",31)(9,"div")(10,"p"),e._uU(11),e.qZA()(),e.TgZ(12,"div"),e.YNc(13,v,2,1,"p",32),e.qZA(),e.TgZ(14,"div")(15,"p"),e._uU(16),e.ALo(17,"date"),e.qZA()()()()()}if(2&m){const n=P.$implicit,o=e.oxw();e.xp6(2),e.Q6J("ngIf",o.toggleInsert&&!n.inserted),e.xp6(1),e.Q6J("ngIf",!o.toggleInsert&&o.displayInsert),e.xp6(1),e.Q6J("ngIf",!o.toggleInsert&&o.displayInsert),e.xp6(3),e.s9C("src",n.album.images[0].url),e.xp6(4),e.Oqu(n.name),e.xp6(2),e.Q6J("ngForOf",n.album.artists),e.xp6(3),e.hij("",e.xi3(17,7,n.duration_ms,"mm:ss")," min")}}var O=(()=>{return(m=O||(O={})).name="name",m.artist="artist",m.date="date",O;var m})();let Y=(()=>{class m{constructor(n,o,s,_,I,i){this.apiService=n,this.route=o,this.authService=s,this.router=_,this.alertCtrl=I,this.toastCtrl=i,this.toggleInsert=!1,this.displayInsert=!1,this.filter=O.name,this.searchFilters=Object.values(O),this.trackToAdd=new V("",new M("","","")),this.route.queryParams.subscribe(t=>{this.displayInsert=this.authService.checkLogged(),console.log("DisplayInsert: "+this.displayInsert),console.log("ToggleInsert: "+this.toggleInsert),console.log("Logged: "+z.e.logged),this.query=t.s,this.searchFilters.includes(t.f)&&(this.filter=t.f),this.search()})}handleDeleteAlert(n){this.alertCtrl.create({header:"Confirmar eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que quieres eliminar esta canci\xf3n?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"confirm",handler:()=>{var o;this.deleteTrack(n),this.tracks=null===(o=this.tracks)||void 0===o?void 0:o.filter(s=>s._id!=n)}}]}).then(o=>o.present())}cancel(){this.modal&&this.modal.dismiss(null,"cancel")}confirm(n){this.modal&&this.modal.dismiss(n,"confirm")}onWillDismiss(n){const o=n;var s;console.log("Will dismiss with: ",o.detail),"confirm"===o.detail.role&&o.detail.data&&(o.detail.data._id=null===(s=o.detail.data)||void 0===s?void 0:s.name,this.insertTrack(o.detail.data))}changeParams(){let n={s:this.query,f:this.filter};""==this.query&&(n.s=void 0),this.router.navigate([],{relativeTo:this.route,queryParams:n,queryParamsHandling:"merge"})}navigateToTrack(n){this.router.navigate([`/tracks/${n}`])}navigateToTrackEdit(n){this.router.navigate([`/tracks/${n}/edit`])}toggleInsertTrack(){this.toggleInsert=!this.toggleInsert,this.search()}search(){console.log(this.query),this.changeParams(),this.query?this.toggleInsert?this.searchSpotify(this.query):this.searchDB(this.query):this.getAllTracks()}searchSpotify(n){var o=this;return(0,h.Z)(function*(){const s=yield o.apiService.searchTracksSpotify(n),_=yield o.apiService.getTracks();for(let I of s)I.inserted=!!_.find(i=>i._id==I._id);o.tracks=s.filter(I=>0==I.inserted)})()}searchDB(n){console.log("searchDB: "+n+" "+this.filter),this.apiService.searchTracks(n,this.filter).subscribe(o=>{this.tracks=o,console.log(this.tracks[0])})}getAllTracks(){var n=this;return(0,h.Z)(function*(){n.tracks=yield n.apiService.getTracks()})()}insertTrack(n){var o=this;return(0,h.Z)(function*(){var s;yield o.apiService.insertTrack(n),o.tracks=null===(s=o.tracks)||void 0===s?void 0:s.filter(_=>_._id!=n._id),o.toastCtrl.create({message:"Canci\xf3n insertada correctamente",duration:2e3}).then(_=>_.present())})()}deleteTrack(n){var o=this;return(0,h.Z)(function*(){console.log("deleteTrack: "+n),(yield o.apiService.deleteTrack(n))?o.toastCtrl.create({message:"Canci\xf3n eliminada correctamente",duration:2e3}).then(_=>_.present()):o.toastCtrl.create({message:"No se ha podido eliminar la canci\xf3n",duration:2e3}).then(_=>_.present())})()}ngOnInit(){}}return m.\u0275fac=function(n){return new(n||m)(e.Y36(Q.j),e.Y36(U.gz),e.Y36(z.e),e.Y36(U.F0),e.Y36(p.Br),e.Y36(p.yF))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-tracks"]],viewQuery:function(n,o){if(1&n&&e.Gf(p.ki,5),2&n){let s;e.iGM(s=e.CRH())&&(o.modal=s.first)}},standalone:!0,features:[e.jDz],decls:23,vars:5,consts:[["slot","start"],["defaultHref","/"],[3,"ngModel","ngModelChange",4,"ngIf"],["slot","end"],[3,"click",4,"ngIf"],["id","open-modal","size","small"],["name","add"],["id","searchBar"],["mode","ios","placeholder","Introduce el nombre de la canci\xf3n",3,"ngModel","keyup.enter","ngModelChange"],[3,"click"],["slot","end","name","search"],["id","container"],["trigger","open-modal",3,"willDismiss"],[3,"fixed"],[1,"ion-justify-content-center"],["button","",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["color","primary",3,"strong","click"],[1,"ion-padding"],["position","stacked"],["type","text","aria-label","Nombre","placeholder","Nombre de la canci\xf3n",3,"ngModel","ngModelChange"],["type","text","aria-label","Artista","placeholder","Artista o grupo",3,"ngModel","ngModelChange"],["type","text","aria-label","URL","placeholder","URL de la imagen",3,"ngModel","ngModelChange"],["button",""],["size","small",3,"click",4,"ngIf"],["size","small","color","light",4,"ngIf"],[4,"ngIf"],["id","img-container"],[3,"src"],["id","card-info"],[4,"ngFor","ngForOf"],["size","small",3,"click"],["size","small","color","light"],["name","ellipsis-vertical"],["name","pencil",3,"click"],["id","delete-alert",3,"click"],["name","trash","color","danger"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e.YNc(5,X,2,2,"ion-segment",2),e.qZA(),e.TgZ(6,"ion-buttons",3),e.YNc(7,G,2,1,"ion-button",4),e.TgZ(8,"ion-fab-button",5),e._UZ(9,"ion-icon",6),e.qZA()()(),e.TgZ(10,"ion-toolbar")(11,"div",7)(12,"ion-searchbar",8),e.NdJ("keyup.enter",function(){return o.search()})("ngModelChange",function(_){return o.query=_}),e.qZA(),e.TgZ(13,"ion-button",9),e.NdJ("click",function(){return o.search()}),e._UZ(14,"ion-icon",10),e._uU(15," Buscar "),e.qZA()()()(),e.TgZ(16,"ion-content")(17,"div",11)(18,"ion-modal",12),e.NdJ("willDismiss",function(_){return o.onWillDismiss(_)}),e.YNc(19,k,22,4,"ng-template"),e.qZA(),e.TgZ(20,"ion-grid",13)(21,"ion-row",14),e.YNc(22,y,18,10,"ion-card",15),e.qZA()()()()),2&n&&(e.xp6(5),e.Q6J("ngIf",!o.toggleInsert),e.xp6(2),e.Q6J("ngIf",o.displayInsert),e.xp6(5),e.Q6J("ngModel",o.query),e.xp6(8),e.Q6J("fixed",!0),e.xp6(2),e.Q6J("ngForOf",o.tracks))},dependencies:[A.ez,A.sg,A.O5,A.uU,L.u5,L.JJ,L.On,p.Pc,p.oU,p.YG,p.Sm,p.PM,p.W2,p.IJ,p.W4,p.zq,p.jY,p.Gu,p.gu,p.Xz,p.pK,p.Ie,p.Q$,p.Nd,p.VI,p.cJ,p.GO,p.wd,p.sr,p.ki,p.QI,p.j9,p.cs,U.Bz],styles:['ion-card[_ngcontent-%COMP%]{width:200px;position:relative;height:300px;background-color:#000;transition:.5s}ion-card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}ion-img[_ngcontent-%COMP%]{height:100%}ion-card[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{position:absolute;z-index:1;top:0;right:0}#img-container[_ngcontent-%COMP%]{position:relative}#img-container[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;top:0;width:100%;height:100%;background:linear-gradient(to bottom,rgba(255,255,255,0) 0,black 100%)}#card-info[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}#card-info[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#000;color:#fff;text-align:center;border-radius:5px;margin:0 auto;width:max-content;padding:0 10px;max-width:80%;box-shadow:0 0 130px 30px var(--ion-color-primary)}#searchBar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:500px;margin:0 auto}#searchBar[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:0 20px}ion-segment[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin:0 auto}']}),m})()},721:(ne,j,f)=>{f.r(j),f.d(j,{routes:()=>A});const A=[{path:"",component:f(6097).H},{path:":id",loadComponent:()=>f.e(6845).then(f.bind(f,6845)).then(L=>L.TrackPage)},{path:":id/edit",loadComponent:()=>f.e(9077).then(f.bind(f,9077)).then(L=>L.EditPage)}]},7542:(ne,j,f)=>{f.d(j,{j:()=>G});var h=f(5861),A=f(529),L=f(6805);function U(k,J){const g="object"==typeof J;return new Promise((l,v)=>{let O,y=!1;k.subscribe({next:Y=>{O=Y,y=!0},error:v,complete:()=>{y?l(O):g?l(J.defaultValue):v(new L.K)}})})}var p=f(4004),V=f(2340),z=f(6097),M=f(4650),e=f(7556);const R=(0,f(7423).fo)("Geolocation",{web:()=>f.e(4561).then(f.bind(f,4561)).then(k=>new k.GeolocationWeb)});let X=(()=>{class k{constructor(){this.coords={latitude:0,longitude:0,accuracy:0}}getLocation(){var g=this;return(0,h.Z)(function*(){const l=yield R.getCurrentPosition();return g.coords.latitude=l.coords.latitude,g.coords.latitude=l.coords.longitude,g.coords.accuracy=l.coords.accuracy,g.coords})()}}return k.\u0275fac=function(g){return new(g||k)},k.\u0275prov=M.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"}),k})(),G=(()=>{class k{constructor(g,l,v){this.http=g,this.authService=l,this.geoService=v,this.url=V.N.url,this.token=this.authService.getJWT()}searchTracksSpotify(g){var l=this;return(0,h.Z)(function*(){try{const v=(yield U(l.http.get(`${l.url}search/${encodeURI(g)}`))).tracks.items;return console.log(v),v.map(y=>({_id:y.id,...y,id:void 0}))}catch(v){return console.log(v),[]}})()}searchTracks(g,l=z.a.name){return this.http.get(`${this.url}tracks/search?${l}=${encodeURI(g)}`,{headers:{Authorization:`Bearer ${this.token}`}}).pipe((0,p.U)(v=>v))}getTrack(g){return this.http.get(`${this.url}tracks/${g}`,{headers:{Authorization:`Bearer ${this.token}`}}).pipe((0,p.U)(l=>l))}getTracks(){var g=this;return(0,h.Z)(function*(){try{return yield U(g.http.get(`${g.url}tracks/`,{headers:{Authorization:`Bearer ${g.token}`}}))}catch(l){l instanceof A.UA&&500===l.status&&console.log("Error getting tracks")}return[]})()}insertTrack(g){var l=this;return(0,h.Z)(function*(){const v=yield l.geoService.getLocation();g.location=v;try{return yield U(l.http.post(`${l.url}tracks/`,g,{headers:{Authorization:`Bearer ${l.token}`}})),!0}catch(y){return y instanceof A.UA&&400===y.status&&console.log("Track already exists"),!1}})()}insertComment(g,l){var v=this;return(0,h.Z)(function*(){try{return yield U(v.http.post(`${v.url}tracks/${g}/comments`,l,{headers:{Authorization:`Bearer ${v.token}`}})),!0}catch(y){return y instanceof A.UA&&404===y.status&&console.log("Track not found"),!1}})()}updateTrack(g){var l=this;return(0,h.Z)(function*(){try{return yield U(l.http.put(`${l.url}tracks/${g._id}`,g,{headers:{Authorization:`Bearer ${l.token}`}})),!0}catch(v){return v instanceof A.UA&&(404===v.status&&console.log("Track not found"),500===v.status&&console.log("Error updating track")),!1}})()}deleteTrack(g){var l=this;return(0,h.Z)(function*(){try{return yield U(l.http.delete(`${l.url}tracks/${g}`,{headers:{Authorization:`Bearer ${l.token}`}})),!0}catch(v){return v instanceof A.UA&&(404===v.status&&console.log("Track not found"),500===v.status&&console.log("Error deleting track")),!1}})()}getComments(g){var l=this;return(0,h.Z)(function*(){let v=[];try{v=yield U(l.http.get(`${l.url}tracks/${g}/comments`,{headers:{Authorization:`Bearer ${l.token}`}}))}catch(y){y instanceof A.UA&&(404===y.status&&console.log("Track not found"),500===y.status&&console.log("Error getting comments"))}return v})()}}return k.\u0275fac=function(g){return new(g||k)(M.LFG(A.eN),M.LFG(e.e),M.LFG(X))},k.\u0275prov=M.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"}),k})()}}]);