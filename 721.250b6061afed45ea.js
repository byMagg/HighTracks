"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[721],{76:(Q,M,u)=>{u.d(M,{GW:()=>v,dk:()=>b,oK:()=>d});var d=(()=>{return(k=d||(d={})).Prompt="PROMPT",k.Camera="CAMERA",k.Photos="PHOTOS",d;var k})(),v=(()=>{return(k=v||(v={})).Rear="REAR",k.Front="FRONT",v;var k})(),b=(()=>{return(k=b||(b={})).Uri="uri",k.Base64="base64",k.DataUrl="dataUrl",b;var k})()},7423:(Q,M,u)=>{u.d(M,{Uw:()=>_,fo:()=>f,xz:()=>$});var d=u(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var C=(()=>{return(c=C||(C={})).Unimplemented="UNIMPLEMENTED",c.Unavailable="UNAVAILABLE",C;var c})();class $ extends Error{constructor(n,a,i){super(n),this.message=n,this.code=a,this.data=i}}const t=c=>{var n,a,i,s,e;const r=c.CapacitorCustomPlatform||null,o=c.Capacitor||{},l=o.Plugins=o.Plugins||{},h=c.CapacitorPlatforms,L=(null===(n=null==h?void 0:h.currentPlatform)||void 0===n?void 0:n.getPlatform)||(()=>null!==r?r.name:(c=>{var n,a;return null!=c&&c.androidBridge?"android":null!==(a=null===(n=null==c?void 0:c.webkit)||void 0===n?void 0:n.messageHandlers)&&void 0!==a&&a.bridge?"ios":"web"})(c)),dt=(null===(a=null==h?void 0:h.currentPlatform)||void 0===a?void 0:a.isNativePlatform)||(()=>"web"!==L()),gt=(null===(i=null==h?void 0:h.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||(T=>{const P=et.get(T);return!!(null!=P&&P.platforms.has(L())||st(T))}),st=(null===(s=null==h?void 0:h.currentPlatform)||void 0===s?void 0:s.getPluginHeader)||(T=>{var P;return null===(P=o.PluginHeaders)||void 0===P?void 0:P.find(B=>B.name===T)}),et=new Map,_t=(null===(e=null==h?void 0:h.currentPlatform)||void 0===e?void 0:e.registerPlugin)||((T,P={})=>{const B=et.get(T);if(B)return console.warn(`Capacitor plugin "${T}" already registered. Cannot register plugins twice.`),B.proxy;const G=L(),H=st(T);let U;const vt=function(){var w=(0,d.Z)(function*(){return!U&&G in P?U=U="function"==typeof P[G]?yield P[G]():P[G]:null!==r&&!U&&"web"in P&&(U=U="function"==typeof P.web?yield P.web():P.web),U});return function(){return w.apply(this,arguments)}}(),nt=w=>{let x;const E=(...J)=>{const S=vt().then(A=>{const j=((w,x)=>{var E,J;if(!H){if(w)return null===(J=w[x])||void 0===J?void 0:J.bind(w);throw new $(`"${T}" plugin is not implemented on ${G}`,C.Unimplemented)}{const S=null==H?void 0:H.methods.find(A=>x===A.name);if(S)return"promise"===S.rtype?A=>o.nativePromise(T,x.toString(),A):(A,j)=>o.nativeCallback(T,x.toString(),A,j);if(w)return null===(E=w[x])||void 0===E?void 0:E.bind(w)}})(A,w);if(j){const R=j(...J);return x=null==R?void 0:R.remove,R}throw new $(`"${T}.${w}()" is not implemented on ${G}`,C.Unimplemented)});return"addListener"===w&&(S.remove=(0,d.Z)(function*(){return x()})),S};return E.toString=()=>`${w.toString()}() { [capacitor code] }`,Object.defineProperty(E,"name",{value:w,writable:!1,configurable:!1}),E},ct=nt("addListener"),lt=nt("removeListener"),Tt=(w,x)=>{const E=ct({eventName:w},x),J=function(){var A=(0,d.Z)(function*(){const j=yield E;lt({eventName:w,callbackId:j},x)});return function(){return A.apply(this,arguments)}}(),S=new Promise(A=>E.then(()=>A({remove:J})));return S.remove=(0,d.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield J()}),S},rt=new Proxy({},{get(w,x){switch(x){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return H?Tt:ct;case"removeListener":return lt;default:return nt(x)}}});return l[T]=rt,et.set(T,{name:T,proxy:rt,platforms:new Set([...Object.keys(P),...H?[G]:[]])}),rt});return o.convertFileSrc||(o.convertFileSrc=T=>T),o.getPlatform=L,o.handleError=T=>c.console.error(T),o.isNativePlatform=dt,o.isPluginAvailable=gt,o.pluginMethodNoop=(T,P,B)=>Promise.reject(`${B} does not have an implementation of "${P}".`),o.registerPlugin=_t,o.Exception=$,o.DEBUG=!!o.DEBUG,o.isLoggingEnabled=!!o.isLoggingEnabled,o.platform=o.getPlatform(),o.isNative=o.isNativePlatform(),o},Z=(c=>c.Capacitor=t(c))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),f=Z.registerPlugin;class _{constructor(n){this.listeners={},this.windowListeners={},n&&(console.warn(`Capacitor WebPlugin "${n.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=n)}addListener(n,a){var i=this;this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push(a);const e=this.windowListeners[n];e&&!e.registered&&this.addWindowListener(e);const r=function(){var l=(0,d.Z)(function*(){return i.removeListener(n,a)});return function(){return l.apply(this,arguments)}}(),o=Promise.resolve({remove:r});return Object.defineProperty(o,"remove",{value:(l=(0,d.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield r()}),function(){return l.apply(this,arguments)})}),o;var l}removeAllListeners(){var n=this;return(0,d.Z)(function*(){n.listeners={};for(const a in n.windowListeners)n.removeWindowListener(n.windowListeners[a]);n.windowListeners={}})()}notifyListeners(n,a){const i=this.listeners[n];i&&i.forEach(s=>s(a))}hasListeners(n){return!!this.listeners[n].length}registerWindowListener(n,a){this.windowListeners[a]={registered:!1,windowEventName:n,pluginEventName:a,handler:i=>{this.notifyListeners(a,i)}}}unimplemented(n="not implemented"){return new Z.Exception(n,C.Unimplemented)}unavailable(n="not available"){return new Z.Exception(n,C.Unavailable)}removeListener(n,a){var i=this;return(0,d.Z)(function*(){const s=i.listeners[n];if(!s)return;const e=s.indexOf(a);i.listeners[n].splice(e,1),i.listeners[n].length||i.removeWindowListener(i.windowListeners[n])})()}addWindowListener(n){window.addEventListener(n.windowEventName,n.handler),n.registered=!0}removeWindowListener(n){n&&(window.removeEventListener(n.windowEventName,n.handler),n.registered=!1)}}const W=c=>encodeURIComponent(c).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Y=c=>c.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class q extends _{getCookies(){return(0,d.Z)(function*(){const n=document.cookie,a={};return n.split(";").forEach(i=>{if(i.length<=0)return;let[s,e]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Y(s).trim(),e=Y(e).trim(),a[s]=e}),a})()}setCookie(n){return(0,d.Z)(function*(){try{const a=W(n.key),i=W(n.value),s=`; expires=${(n.expires||"").replace("expires=","")}`,e=(n.path||"/").replace("path=",""),r=null!=n.url&&n.url.length>0?`domain=${n.url}`:"";document.cookie=`${a}=${i||""}${s}; path=${e}; ${r};`}catch(a){return Promise.reject(a)}})()}deleteCookie(n){return(0,d.Z)(function*(){try{document.cookie=`${n.key}=; Max-Age=0`}catch(a){return Promise.reject(a)}})()}clearCookies(){return(0,d.Z)(function*(){try{const n=document.cookie.split(";")||[];for(const a of n)document.cookie=a.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(n){return Promise.reject(n)}})()}clearAllCookies(){var n=this;return(0,d.Z)(function*(){try{yield n.clearCookies()}catch(a){return Promise.reject(a)}})()}}f("CapacitorCookies",{web:()=>new q});const K=function(){var c=(0,d.Z)(function*(n){return new Promise((a,i)=>{const s=new FileReader;s.onload=()=>{const e=s.result;a(e.indexOf(",")>=0?e.split(",")[1]:e)},s.onerror=e=>i(e),s.readAsDataURL(n)})});return function(a){return c.apply(this,arguments)}}();class tt extends _{request(n){return(0,d.Z)(function*(){const a=((c,n={})=>{const a=Object.assign({method:c.method||"GET",headers:c.headers},n),s=((c={})=>{const n=Object.keys(c);return Object.keys(c).map(s=>s.toLocaleLowerCase()).reduce((s,e,r)=>(s[e]=c[n[r]],s),{})})(c.headers)["content-type"]||"";if("string"==typeof c.data)a.body=c.data;else if(s.includes("application/x-www-form-urlencoded")){const e=new URLSearchParams;for(const[r,o]of Object.entries(c.data||{}))e.set(r,o);a.body=e.toString()}else if(s.includes("multipart/form-data")){const e=new FormData;if(c.data instanceof FormData)c.data.forEach((o,l)=>{e.append(l,o)});else for(const o of Object.keys(c.data))e.append(o,c.data[o]);a.body=e;const r=new Headers(a.headers);r.delete("content-type"),a.headers=r}else(s.includes("application/json")||"object"==typeof c.data)&&(a.body=JSON.stringify(c.data));return a})(n,n.webFetchExtra),i=((c,n=!0)=>c?Object.entries(c).reduce((i,s)=>{const[e,r]=s;let o,l;return Array.isArray(r)?(l="",r.forEach(h=>{o=n?encodeURIComponent(h):h,l+=`${e}=${o}&`}),l.slice(0,-1)):(o=n?encodeURIComponent(r):r,l=`${e}=${o}`),`${i}&${l}`},"").substr(1):null)(n.params,n.shouldEncodeUrlParams),s=i?`${n.url}?${i}`:n.url,e=yield fetch(s,a),r=e.headers.get("content-type")||"";let l,h,{responseType:o="text"}=e.ok?n:{};switch(r.includes("application/json")&&(o="json"),o){case"arraybuffer":case"blob":h=yield e.blob(),l=yield K(h);break;case"json":l=yield e.json();break;default:l=yield e.text()}const I={};return e.headers.forEach((L,F)=>{I[F]=L}),{data:l,headers:I,status:e.status,url:e.url}})()}get(n){var a=this;return(0,d.Z)(function*(){return a.request(Object.assign(Object.assign({},n),{method:"GET"}))})()}post(n){var a=this;return(0,d.Z)(function*(){return a.request(Object.assign(Object.assign({},n),{method:"POST"}))})()}put(n){var a=this;return(0,d.Z)(function*(){return a.request(Object.assign(Object.assign({},n),{method:"PUT"}))})()}patch(n){var a=this;return(0,d.Z)(function*(){return a.request(Object.assign(Object.assign({},n),{method:"PATCH"}))})()}delete(n){var a=this;return(0,d.Z)(function*(){return a.request(Object.assign(Object.assign({},n),{method:"DELETE"}))})()}}f("CapacitorHttp",{web:()=>new tt})},9425:(Q,M,u)=>{u.d(M,{a:()=>n,H:()=>a});var d=u(5861),v=u(6895),b=u(433),k=u(1194),p=u(650);class O{constructor(s,e,r){this._id=s,r&&(this._id=r),this.name=s,this.album=e}}class N{constructor(s,e,r){this.name=e,this.artists=[{name:s}],this.images=[{url:r}]}}var C=u(7423),$=u(76);const z=(0,C.fo)("Camera",{web:()=>u.e(3954).then(u.bind(u,3954)).then(i=>new i.CameraWeb)});var t=u(4650),y=u(8672),Z=u(7556),f=u(1481);function g(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-segment-button",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.changeParams())}),t._uU(1),t.qZA()}if(2&i){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function m(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-segment",16),t.NdJ("ngModelChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.filter=o)}),t.YNc(1,g,2,2,"ion-segment-button",17),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("ngModel",e.filter),t.xp6(1),t.Q6J("ngForOf",e.searchFilters)}}function _(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.toggleInsertTrack())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.toggleInsert?"Mostrar listado":"Buscar spotify"," ")}}function it(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label",21),t._uU(2,"URL imagen"),t.qZA(),t.TgZ(3,"ion-input",28),t.NdJ("ngModelChange",function(o){t.CHM(e);const l=t.oxw(2);return t.KtG(l.trackToAdd.album.images[0].url=o)}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(3),t.Q6J("ngModel",e.trackToAdd.album.images[0].url)}}function W(i,s){1&i&&t._UZ(0,"ion-img",34)}function Y(i,s){if(1&i&&t._UZ(0,"ion-img",35),2&i){const e=t.oxw(3);t.Q6J("src","data:image/jpeg;base64,"+e.trackToAdd.album.images[0].imageBase64String)}}function q(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",29),t.YNc(1,W,1,0,"ion-img",30),t.YNc(2,Y,1,1,"ion-img",31),t.TgZ(3,"ion-fab",32)(4,"ion-fab-button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.takePicture())}),t._UZ(5,"ion-icon",33),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.trackToAdd.album.images[0].imageBase64String),t.xp6(1),t.Q6J("ngIf",e.trackToAdd.album.images[0].imageBase64String)}}function ot(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"A\xf1adir canci\xf3n"),t.qZA(),t.TgZ(4,"ion-buttons",3)(5,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.cancel())}),t._uU(6,"Cancelar"),t.qZA(),t.TgZ(7,"ion-button",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.confirm(o.trackToAdd))}),t._uU(8,"A\xf1adir"),t.qZA()()()(),t.TgZ(9,"ion-content",20)(10,"ion-item")(11,"ion-label",21),t._uU(12,"Nombre"),t.qZA(),t.TgZ(13,"ion-input",22),t.NdJ("ngModelChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.trackToAdd.name=o)}),t.qZA()(),t.TgZ(14,"ion-item")(15,"ion-label",21),t._uU(16,"Artista/Grupo"),t.qZA(),t.TgZ(17,"ion-input",23),t.NdJ("ngModelChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.trackToAdd.album.artists[0].name=o)}),t.qZA()(),t.TgZ(18,"ion-segment",16),t.NdJ("ngModelChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.togglePhoto=o)}),t.TgZ(19,"ion-segment-button",24)(20,"ion-label"),t._uU(21,"URL"),t.qZA()(),t.TgZ(22,"ion-segment-button",25)(23,"ion-label"),t._uU(24,"Imagen"),t.qZA()()(),t.YNc(25,it,4,1,"ion-item",26),t.YNc(26,q,6,2,"div",27),t.qZA()}if(2&i){const e=t.oxw();t.xp6(7),t.Q6J("strong",!0),t.xp6(6),t.Q6J("ngModel",e.trackToAdd.name),t.xp6(4),t.Q6J("ngModel",e.trackToAdd.album.artists[0].name),t.xp6(1),t.Q6J("ngModel",e.togglePhoto),t.xp6(7),t.Q6J("ngIf","url"===e.togglePhoto),t.xp6(1),t.Q6J("ngIf","img"===e.togglePhoto)}}function K(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-fab-button",42),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,l=t.oxw();return t.KtG(l.insertTrack(o))}),t._UZ(1,"ion-icon",6),t.qZA()}}function D(i,s){1&i&&(t.TgZ(0,"ion-fab-button",43),t._UZ(1,"ion-icon",44),t.qZA())}function V(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-fab-list")(1,"ion-fab-button")(2,"ion-icon",45),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,l=t.oxw();return t.KtG(l.navigateToTrackEdit(o._id))}),t.qZA()(),t.TgZ(3,"ion-fab-button",46),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,l=t.oxw();return t.KtG(l.handleDeleteAlert(o._id))}),t._UZ(4,"ion-icon",47),t.qZA()()}}function X(i,s){if(1&i&&t._UZ(0,"ion-img",35),2&i){const e=t.oxw().$implicit;t.s9C("src",e.album.images[0].url)}}function tt(i,s){if(1&i&&t._UZ(0,"ion-img",35),2&i){const e=t.oxw().$implicit;t.Q6J("src","data:image/jpeg;base64,"+e.album.images[0].imageBase64String)}}function at(i,s){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&i){const e=s.$implicit;t.xp6(1),t.Oqu(e.name)}}function c(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"ion-card",36)(1,"ion-fab"),t.YNc(2,K,2,0,"ion-fab-button",37),t.YNc(3,D,2,0,"ion-fab-button",38),t.YNc(4,V,5,0,"ion-fab-list",26),t.qZA(),t.TgZ(5,"div",9),t.NdJ("click",function(){const l=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.navigateToTrack(l._id))}),t.TgZ(6,"div",39),t.YNc(7,X,1,1,"ion-img",31),t.YNc(8,tt,1,1,"ion-img",31),t.qZA(),t.TgZ(9,"div",40)(10,"div")(11,"p"),t._uU(12),t.qZA()(),t.TgZ(13,"div"),t.YNc(14,at,2,1,"p",41),t.qZA(),t.TgZ(15,"div")(16,"p"),t._uU(17),t.ALo(18,"date"),t.qZA()()()()()}if(2&i){const e=s.$implicit,r=t.oxw();t.xp6(2),t.Q6J("ngIf",r.toggleInsert&&!e.inserted),t.xp6(1),t.Q6J("ngIf",!r.toggleInsert&&r.displayInsert),t.xp6(1),t.Q6J("ngIf",!r.toggleInsert&&r.displayInsert),t.xp6(3),t.Q6J("ngIf",e.album.images[0].url),t.xp6(1),t.Q6J("ngIf",e.album.images[0].imageBase64String),t.xp6(4),t.Oqu(e.name),t.xp6(2),t.Q6J("ngForOf",e.album.artists),t.xp6(3),t.hij("",t.xi3(18,8,e.duration_ms,"mm:ss")," min")}}var n=(()=>{return(i=n||(n={})).name="name",i.artist="artist",i.date="date",n;var i})();let a=(()=>{class i{constructor(e,r,o,l,h,I,L){this.apiService=e,this.route=r,this.authService=o,this.router=l,this.alertCtrl=h,this.toastCtrl=I,this.sanitizer=L,this.toggleInsert=!1,this.displayInsert=!1,this.filter=n.name,this.searchFilters=Object.values(n),this.trackToAdd=new O("",new N("","","")),this.togglePhoto="url",this.route.queryParams.subscribe(F=>{this.displayInsert=this.authService.checkLogged(),this.query=F.s,this.searchFilters.includes(F.f)&&(this.filter=F.f),this.search()})}handleDeleteAlert(e){this.alertCtrl.create({header:"Confirmar eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que quieres eliminar esta canci\xf3n?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"confirm",handler:()=>{var r;this.deleteTrack(e),this.tracks=null===(r=this.tracks)||void 0===r?void 0:r.filter(o=>o._id!=e)}}]}).then(r=>r.present())}cancel(){this.modal&&this.modal.dismiss(null,"cancel")}confirm(e){this.modal&&this.modal.dismiss(e,"confirm")}onWillDismiss(e){const r=e;var o;console.log("Will dismiss with: ",r.detail),"confirm"===r.detail.role&&r.detail.data&&(r.detail.data._id=null===(o=r.detail.data)||void 0===o?void 0:o.name,"url"==this.togglePhoto&&(r.detail.data.album.images[0].imageBase64String=void 0),"img"==this.togglePhoto&&(r.detail.data.album.images[0].url=void 0),this.insertTrack(r.detail.data))}changeParams(){let e={s:this.query,f:this.filter};""==this.query&&(e.s=void 0),this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge"})}navigateToTrack(e){this.router.navigate([`/tracks/${e}`])}navigateToTrackEdit(e){this.router.navigate([`/tracks/${e}/edit`])}toggleInsertTrack(){this.toggleInsert=!this.toggleInsert,this.search()}search(){this.changeParams(),this.query?this.toggleInsert?this.searchSpotify(this.query):this.searchDB(this.query):this.getAllTracks()}searchSpotify(e){var r=this;return(0,d.Z)(function*(){const o=yield r.apiService.searchTracksSpotify(e),l=yield r.apiService.getTracks();for(let h of o)h.inserted=!!l.find(I=>I._id==h._id);r.tracks=o.filter(h=>0==h.inserted)})()}searchDB(e){var r=this;return(0,d.Z)(function*(){try{r.tracks=yield r.apiService.searchTracks(e,r.filter)}catch(o){o instanceof Error&&console.error(o.message)}})()}getAllTracks(){var e=this;return(0,d.Z)(function*(){try{e.tracks=yield e.apiService.getTracks()}catch(r){r instanceof Error&&console.error(r.message)}})()}insertTrack(e){var r=this;return(0,d.Z)(function*(){var o;yield r.apiService.insertTrack(e),r.tracks=null===(o=r.tracks)||void 0===o?void 0:o.filter(l=>l._id!=e._id),r.toastCtrl.create({message:"Canci\xf3n insertada correctamente",duration:2e3}).then(l=>l.present())})()}deleteTrack(e){var r=this;return(0,d.Z)(function*(){console.log("deleteTrack: "+e),(yield r.apiService.deleteTrack(e))?r.toastCtrl.create({message:"Canci\xf3n eliminada correctamente",duration:2e3}).then(l=>l.present()):r.toastCtrl.create({message:"No se ha podido eliminar la canci\xf3n",duration:2e3}).then(l=>l.present())})()}takePicture(){var e=this;return(0,d.Z)(function*(){const r=yield z.getPhoto({quality:100,allowEditing:!1,resultType:$.dk.Base64});r&&r.base64String&&(e.trackToAdd.album.images[0]={imageBase64String:r.base64String})})()}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(y.j),t.Y36(k.gz),t.Y36(Z.e),t.Y36(k.F0),t.Y36(p.Br),t.Y36(p.yF),t.Y36(f.H7))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-tracks"]],viewQuery:function(e,r){if(1&e&&t.Gf(p.ki,5),2&e){let o;t.iGM(o=t.CRH())&&(r.modal=o.first)}},standalone:!0,features:[t.jDz],decls:23,vars:5,consts:[["slot","start"],["defaultHref","/"],[3,"ngModel","ngModelChange",4,"ngIf"],["slot","end"],[3,"click",4,"ngIf"],["id","open-modal","size","small"],["name","add"],["id","searchBar"],["mode","ios","placeholder","Introduce el nombre de la canci\xf3n",3,"ngModel","keyup.enter","ngModelChange"],[3,"click"],["slot","end","name","search"],["id","container"],["trigger","open-modal",3,"willDismiss"],[3,"fixed"],[1,"ion-justify-content-center"],["button","",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["color","primary",3,"strong","click"],[1,"ion-padding"],["position","stacked"],["type","text","aria-label","Nombre","placeholder","Nombre de la canci\xf3n",3,"ngModel","ngModelChange"],["type","text","aria-label","Artista","placeholder","Artista o grupo",3,"ngModel","ngModelChange"],["value","url"],["value","img"],[4,"ngIf"],["style","padding: 45px 0;",4,"ngIf"],["type","text","aria-label","URL","placeholder","URL de la imagen",3,"ngModel","ngModelChange"],[2,"padding","45px 0"],["src","../../../assets/placeholder.png",4,"ngIf"],[3,"src",4,"ngIf"],["vertical","bottom","horizontal","center","slot","fixed"],["name","camera"],["src","../../../assets/placeholder.png"],[3,"src"],["button",""],["size","small",3,"click",4,"ngIf"],["size","small","color","light",4,"ngIf"],["id","img-container"],["id","card-info"],[4,"ngFor","ngForOf"],["size","small",3,"click"],["size","small","color","light"],["name","ellipsis-vertical"],["name","pencil",3,"click"],["id","delete-alert",3,"click"],["name","trash","color","danger"]],template:function(e,r){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t.YNc(5,m,2,2,"ion-segment",2),t.qZA(),t.TgZ(6,"ion-buttons",3),t.YNc(7,_,2,1,"ion-button",4),t.TgZ(8,"ion-fab-button",5),t._UZ(9,"ion-icon",6),t.qZA()()(),t.TgZ(10,"ion-toolbar")(11,"div",7)(12,"ion-searchbar",8),t.NdJ("keyup.enter",function(){return r.search()})("ngModelChange",function(l){return r.query=l}),t.qZA(),t.TgZ(13,"ion-button",9),t.NdJ("click",function(){return r.search()}),t._UZ(14,"ion-icon",10),t._uU(15," Buscar "),t.qZA()()()(),t.TgZ(16,"ion-content")(17,"div",11)(18,"ion-modal",12),t.NdJ("willDismiss",function(l){return r.onWillDismiss(l)}),t.YNc(19,ot,27,6,"ng-template"),t.qZA(),t.TgZ(20,"ion-grid",13)(21,"ion-row",14),t.YNc(22,c,19,11,"ion-card",15),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("ngIf",!r.toggleInsert),t.xp6(2),t.Q6J("ngIf",r.displayInsert),t.xp6(5),t.Q6J("ngModel",r.query),t.xp6(8),t.Q6J("fixed",!0),t.xp6(2),t.Q6J("ngForOf",r.tracks))},dependencies:[v.ez,v.sg,v.O5,v.uU,b.u5,b.JJ,b.On,p.Pc,p.oU,p.YG,p.Sm,p.PM,p.W2,p.IJ,p.W4,p.zq,p.jY,p.Gu,p.gu,p.Xz,p.pK,p.Ie,p.Q$,p.Nd,p.VI,p.cJ,p.GO,p.wd,p.sr,p.ki,p.QI,p.j9,p.cs,k.Bz],styles:['ion-card[_ngcontent-%COMP%]{width:200px;position:relative;height:300px;background-color:#000;transition:.5s}ion-card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}ion-img[_ngcontent-%COMP%]{height:100%}ion-card[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{position:absolute;z-index:1;top:0;right:0}#img-container[_ngcontent-%COMP%]{position:relative}#img-container[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;top:0;width:100%;height:100%;background:linear-gradient(to bottom,rgba(255,255,255,0) 0,black 100%)}#card-info[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}#card-info[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#000;color:#fff;text-align:center;border-radius:5px;margin:0 auto;width:max-content;padding:0 10px;max-width:80%;box-shadow:0 0 130px 30px var(--ion-color-primary)}#searchBar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:500px;margin:0 auto}#searchBar[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:0 20px}ion-segment[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin:0 auto}ion-modal[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:45%;margin:0 auto}@media (max-width: 768px){ion-modal[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:90%;margin:0 auto}}']}),i})()},721:(Q,M,u)=>{u.r(M),u.d(M,{routes:()=>v});const v=[{path:"",component:u(9425).H},{path:":id",loadComponent:()=>u.e(6845).then(u.bind(u,6845)).then(b=>b.TrackPage)},{path:":id/edit",loadComponent:()=>u.e(9077).then(u.bind(u,9077)).then(b=>b.EditPage)}]},8672:(Q,M,u)=>{u.d(M,{j:()=>t});var d=u(5861),v=u(529),b=u(9808),k=u(2340),p=u(9425),O=u(4650),N=u(7556);const $=(0,u(7423).fo)("Geolocation",{web:()=>u.e(4561).then(u.bind(u,4561)).then(y=>new y.GeolocationWeb)});let z=(()=>{class y{constructor(){this.coords={latitude:0,longitude:0,accuracy:0}}getLocation(){var f=this;return(0,d.Z)(function*(){const g=yield $.getCurrentPosition();return f.coords.latitude=g.coords.latitude,f.coords.latitude=g.coords.longitude,f.coords.accuracy=g.coords.accuracy,f.coords})()}}return y.\u0275fac=function(f){return new(f||y)},y.\u0275prov=O.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})(),t=(()=>{class y{constructor(f,g,m){this.http=f,this.authService=g,this.geoService=m,this.url=k.N.url,this.token=this.authService.getJWT()}searchTracksSpotify(f){var g=this;return(0,d.Z)(function*(){try{const m=(yield(0,b.n)(g.http.get(`${g.url}search/${encodeURI(f)}`))).tracks.items;return console.log(m),m.map(_=>({_id:_.id,..._,id:void 0}))}catch(m){return console.log(m),[]}})()}searchTracks(f,g=p.a.name){var m=this;return(0,d.Z)(function*(){try{return yield(0,b.n)(m.http.get(`${m.url}tracks/search?${g}=${encodeURI(f)}`,{headers:{Authorization:`Bearer ${m.token}`}}))}catch(_){if(_ instanceof v.UA){if(404===_.status)throw new Error("Track not found");if(500===_.status)throw new Error("Error getting track");if(0===_.status)throw new Error("Error connecting to server")}throw _}})()}getTrack(f){var g=this;return(0,d.Z)(function*(){try{return yield(0,b.n)(g.http.get(`${g.url}tracks/${f}`,{headers:{Authorization:`Bearer ${g.token}`}}))}catch(m){if(m instanceof v.UA){if(404===m.status)throw new Error("Track not found");if(500===m.status)throw new Error("Error getting track");if(0===m.status)throw new Error("Error connecting to server")}throw m}})()}getTracks(){var f=this;return(0,d.Z)(function*(){try{return yield(0,b.n)(f.http.get(`${f.url}tracks/`,{headers:{Authorization:`Bearer ${f.token}`}}))}catch(g){if(g instanceof v.UA){if(500===g.status)throw new Error("Error getting track");if(0===g.status)throw new Error("Error connecting to server")}}return[]})()}insertTrack(f){var g=this;return(0,d.Z)(function*(){const m=yield g.geoService.getLocation();f.location=m;try{return yield(0,b.n)(g.http.post(`${g.url}tracks/`,f,{headers:{Authorization:`Bearer ${g.token}`}})),!0}catch(_){if(_ instanceof v.UA&&400===_.status)throw Error("Track already exists");return!1}})()}insertComment(f,g){var m=this;return(0,d.Z)(function*(){try{return yield(0,b.n)(m.http.post(`${m.url}tracks/${f}/comments`,g,{headers:{Authorization:`Bearer ${m.token}`}})),!0}catch(_){return _ instanceof v.UA&&404===_.status&&console.log("Track not found"),!1}})()}updateTrack(f){var g=this;return(0,d.Z)(function*(){try{return yield(0,b.n)(g.http.put(`${g.url}tracks/${f._id}`,f,{headers:{Authorization:`Bearer ${g.token}`}})),!0}catch(m){return m instanceof v.UA&&(404===m.status&&console.log("Track not found"),500===m.status&&console.log("Error updating track")),!1}})()}deleteTrack(f){var g=this;return(0,d.Z)(function*(){try{return yield(0,b.n)(g.http.delete(`${g.url}tracks/${f}`,{headers:{Authorization:`Bearer ${g.token}`}})),!0}catch(m){return m instanceof v.UA&&(404===m.status&&console.log("Track not found"),500===m.status&&console.log("Error deleting track")),!1}})()}getComments(f){var g=this;return(0,d.Z)(function*(){let m=[];try{m=yield(0,b.n)(g.http.get(`${g.url}tracks/${f}/comments`,{headers:{Authorization:`Bearer ${g.token}`}}))}catch(_){_ instanceof v.UA&&(404===_.status&&console.log("Track not found"),500===_.status&&console.log("Error getting comments"))}return m})()}}return y.\u0275fac=function(f){return new(f||y)(O.LFG(v.eN),O.LFG(N.e),O.LFG(z))},y.\u0275prov=O.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()}}]);