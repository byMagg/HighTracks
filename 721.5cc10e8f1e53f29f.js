"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[721],{76:(Q,M,u)=>{u.d(M,{GW:()=>v,dk:()=>b,oK:()=>l});var l=(()=>{return(T=l||(l={})).Prompt="PROMPT",T.Camera="CAMERA",T.Photos="PHOTOS",l;var T})(),v=(()=>{return(T=v||(v={})).Rear="REAR",T.Front="FRONT",v;var T})(),b=(()=>{return(T=b||(b={})).Uri="uri",T.Base64="base64",T.DataUrl="dataUrl",b;var T})()},7423:(Q,M,u)=>{u.d(M,{Uw:()=>_,fo:()=>f,xz:()=>O});var l=u(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var C=(()=>{return(c=C||(C={})).Unimplemented="UNIMPLEMENTED",c.Unavailable="UNAVAILABLE",C;var c})();class O extends Error{constructor(o,n,s){super(o),this.message=o,this.code=n,this.data=s}}const t=c=>{var o,n,s,e,r;const i=c.CapacitorCustomPlatform||null,a=c.Capacitor||{},h=a.Plugins=a.Plugins||{},p=c.CapacitorPlatforms,G=(null===(o=null==p?void 0:p.currentPlatform)||void 0===o?void 0:o.getPlatform)||(()=>null!==i?i.name:(c=>{var o,n;return null!=c&&c.androidBridge?"android":null!==(n=null===(o=null==c?void 0:c.webkit)||void 0===o?void 0:o.messageHandlers)&&void 0!==n&&n.bridge?"ios":"web"})(c)),dt=(null===(n=null==p?void 0:p.currentPlatform)||void 0===n?void 0:n.isNativePlatform)||(()=>"web"!==G()),gt=(null===(s=null==p?void 0:p.currentPlatform)||void 0===s?void 0:s.isPluginAvailable)||(k=>{const P=nt.get(k);return!!(null!=P&&P.platforms.has(G())||st(k))}),st=(null===(e=null==p?void 0:p.currentPlatform)||void 0===e?void 0:e.getPluginHeader)||(k=>{var P;return null===(P=a.PluginHeaders)||void 0===P?void 0:P.find(j=>j.name===k)}),nt=new Map,pt=(null===(r=null==p?void 0:p.currentPlatform)||void 0===r?void 0:r.registerPlugin)||((k,P={})=>{const j=nt.get(k);if(j)return console.warn(`Capacitor plugin "${k}" already registered. Cannot register plugins twice.`),j.proxy;const S=G(),B=st(k);let U;const vt=function(){var w=(0,l.Z)(function*(){return!U&&S in P?U=U="function"==typeof P[S]?yield P[S]():P[S]:null!==i&&!U&&"web"in P&&(U=U="function"==typeof P.web?yield P.web():P.web),U});return function(){return w.apply(this,arguments)}}(),rt=w=>{let x;const E=(...I)=>{const J=vt().then(A=>{const F=((w,x)=>{var E,I;if(!B){if(w)return null===(I=w[x])||void 0===I?void 0:I.bind(w);throw new O(`"${k}" plugin is not implemented on ${S}`,C.Unimplemented)}{const J=null==B?void 0:B.methods.find(A=>x===A.name);if(J)return"promise"===J.rtype?A=>a.nativePromise(k,x.toString(),A):(A,F)=>a.nativeCallback(k,x.toString(),A,F);if(w)return null===(E=w[x])||void 0===E?void 0:E.bind(w)}})(A,w);if(F){const R=F(...I);return x=null==R?void 0:R.remove,R}throw new O(`"${k}.${w}()" is not implemented on ${S}`,C.Unimplemented)});return"addListener"===w&&(J.remove=(0,l.Z)(function*(){return x()})),J};return E.toString=()=>`${w.toString()}() { [capacitor code] }`,Object.defineProperty(E,"name",{value:w,writable:!1,configurable:!1}),E},ct=rt("addListener"),lt=rt("removeListener"),kt=(w,x)=>{const E=ct({eventName:w},x),I=function(){var A=(0,l.Z)(function*(){const F=yield E;lt({eventName:w,callbackId:F},x)});return function(){return A.apply(this,arguments)}}(),J=new Promise(A=>E.then(()=>A({remove:I})));return J.remove=(0,l.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield I()}),J},ot=new Proxy({},{get(w,x){switch(x){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return B?kt:ct;case"removeListener":return lt;default:return rt(x)}}});return h[k]=ot,nt.set(k,{name:k,proxy:ot,platforms:new Set([...Object.keys(P),...B?[S]:[]])}),ot});return a.convertFileSrc||(a.convertFileSrc=k=>k),a.getPlatform=G,a.handleError=k=>c.console.error(k),a.isNativePlatform=dt,a.isPluginAvailable=gt,a.pluginMethodNoop=(k,P,j)=>Promise.reject(`${j} does not have an implementation of "${P}".`),a.registerPlugin=pt,a.Exception=O,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},Z=(c=>c.Capacitor=t(c))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),f=Z.registerPlugin;class _{constructor(o){this.listeners={},this.windowListeners={},o&&(console.warn(`Capacitor WebPlugin "${o.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=o)}addListener(o,n){var s=this;this.listeners[o]||(this.listeners[o]=[]),this.listeners[o].push(n);const r=this.windowListeners[o];r&&!r.registered&&this.addWindowListener(r);const i=function(){var h=(0,l.Z)(function*(){return s.removeListener(o,n)});return function(){return h.apply(this,arguments)}}(),a=Promise.resolve({remove:i});return Object.defineProperty(a,"remove",{value:(h=(0,l.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield i()}),function(){return h.apply(this,arguments)})}),a;var h}removeAllListeners(){var o=this;return(0,l.Z)(function*(){o.listeners={};for(const n in o.windowListeners)o.removeWindowListener(o.windowListeners[n]);o.windowListeners={}})()}notifyListeners(o,n){const s=this.listeners[o];s&&s.forEach(e=>e(n))}hasListeners(o){return!!this.listeners[o].length}registerWindowListener(o,n){this.windowListeners[n]={registered:!1,windowEventName:o,pluginEventName:n,handler:s=>{this.notifyListeners(n,s)}}}unimplemented(o="not implemented"){return new Z.Exception(o,C.Unimplemented)}unavailable(o="not available"){return new Z.Exception(o,C.Unavailable)}removeListener(o,n){var s=this;return(0,l.Z)(function*(){const e=s.listeners[o];if(!e)return;const r=e.indexOf(n);s.listeners[o].splice(r,1),s.listeners[o].length||s.removeWindowListener(s.windowListeners[o])})()}addWindowListener(o){window.addEventListener(o.windowEventName,o.handler),o.registered=!0}removeWindowListener(o){o&&(window.removeEventListener(o.windowEventName,o.handler),o.registered=!1)}}const W=c=>encodeURIComponent(c).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),q=c=>c.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Y extends _{getCookies(){return(0,l.Z)(function*(){const o=document.cookie,n={};return o.split(";").forEach(s=>{if(s.length<=0)return;let[e,r]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");e=q(e).trim(),r=q(r).trim(),n[e]=r}),n})()}setCookie(o){return(0,l.Z)(function*(){try{const n=W(o.key),s=W(o.value),e=`; expires=${(o.expires||"").replace("expires=","")}`,r=(o.path||"/").replace("path=",""),i=null!=o.url&&o.url.length>0?`domain=${o.url}`:"";document.cookie=`${n}=${s||""}${e}; path=${r}; ${i};`}catch(n){return Promise.reject(n)}})()}deleteCookie(o){return(0,l.Z)(function*(){try{document.cookie=`${o.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}})()}clearCookies(){return(0,l.Z)(function*(){try{const o=document.cookie.split(";")||[];for(const n of o)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(o){return Promise.reject(o)}})()}clearAllCookies(){var o=this;return(0,l.Z)(function*(){try{yield o.clearCookies()}catch(n){return Promise.reject(n)}})()}}f("CapacitorCookies",{web:()=>new Y});const K=function(){var c=(0,l.Z)(function*(o){return new Promise((n,s)=>{const e=new FileReader;e.onload=()=>{const r=e.result;n(r.indexOf(",")>=0?r.split(",")[1]:r)},e.onerror=r=>s(r),e.readAsDataURL(o)})});return function(n){return c.apply(this,arguments)}}();class tt extends _{request(o){return(0,l.Z)(function*(){const n=((c,o={})=>{const n=Object.assign({method:c.method||"GET",headers:c.headers},o),e=((c={})=>{const o=Object.keys(c);return Object.keys(c).map(e=>e.toLocaleLowerCase()).reduce((e,r,i)=>(e[r]=c[o[i]],e),{})})(c.headers)["content-type"]||"";if("string"==typeof c.data)n.body=c.data;else if(e.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams;for(const[i,a]of Object.entries(c.data||{}))r.set(i,a);n.body=r.toString()}else if(e.includes("multipart/form-data")){const r=new FormData;if(c.data instanceof FormData)c.data.forEach((a,h)=>{r.append(h,a)});else for(const a of Object.keys(c.data))r.append(a,c.data[a]);n.body=r;const i=new Headers(n.headers);i.delete("content-type"),n.headers=i}else(e.includes("application/json")||"object"==typeof c.data)&&(n.body=JSON.stringify(c.data));return n})(o,o.webFetchExtra),s=((c,o=!0)=>c?Object.entries(c).reduce((s,e)=>{const[r,i]=e;let a,h;return Array.isArray(i)?(h="",i.forEach(p=>{a=o?encodeURIComponent(p):p,h+=`${r}=${a}&`}),h.slice(0,-1)):(a=o?encodeURIComponent(i):i,h=`${r}=${a}`),`${s}&${h}`},"").substr(1):null)(o.params,o.shouldEncodeUrlParams),e=s?`${o.url}?${s}`:o.url,r=yield fetch(e,n),i=r.headers.get("content-type")||"";let h,p,{responseType:a="text"}=r.ok?o:{};switch(i.includes("application/json")&&(a="json"),a){case"arraybuffer":case"blob":p=yield r.blob(),h=yield K(p);break;case"json":h=yield r.json();break;default:h=yield r.text()}const L={};return r.headers.forEach((G,et)=>{L[et]=G}),{data:h,headers:L,status:r.status,url:r.url}})()}get(o){var n=this;return(0,l.Z)(function*(){return n.request(Object.assign(Object.assign({},o),{method:"GET"}))})()}post(o){var n=this;return(0,l.Z)(function*(){return n.request(Object.assign(Object.assign({},o),{method:"POST"}))})()}put(o){var n=this;return(0,l.Z)(function*(){return n.request(Object.assign(Object.assign({},o),{method:"PUT"}))})()}patch(o){var n=this;return(0,l.Z)(function*(){return n.request(Object.assign(Object.assign({},o),{method:"PATCH"}))})()}delete(o){var n=this;return(0,l.Z)(function*(){return n.request(Object.assign(Object.assign({},o),{method:"DELETE"}))})()}}f("CapacitorHttp",{web:()=>new tt})},9425:(Q,M,u)=>{u.d(M,{a:()=>c,H:()=>o});var l=u(5861),v=u(6895),b=u(433),T=u(1194),m=u(650);class ${constructor(s,e,r){this._id=s,r&&(this._id=r),this.name=s,this.album=e}}class H{constructor(s,e,r){this.name=e,this.artists=[{name:s}],this.images=[{url:r}]}}var C=u(7423),O=u(76);const N=(0,C.fo)("Camera",{web:()=>u.e(3954).then(u.bind(u,3954)).then(n=>new n.CameraWeb)});var t=u(4650),y=u(8672),Z=u(7556);function f(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-segment-button",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.changeParams())}),t._uU(1),t.qZA()}if(2&n){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function d(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-segment",13),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.filter=i)}),t.YNc(1,f,2,2,"ion-segment-button",14),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("ngModel",e.filter),t.xp6(1),t.Q6J("ngForOf",e.searchFilters)}}function g(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-buttons",16)(1,"ion-button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.toggleInsertTrack())}),t._uU(2),t.qZA(),t.TgZ(3,"ion-fab-button",17),t._UZ(4,"ion-icon",18),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.hij(" ",e.toggleInsert?"Mostrar listado":"Buscar spotify"," ")}}function _(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item")(1,"ion-label",21),t._uU(2,"URL imagen"),t.qZA(),t.TgZ(3,"ion-input",28),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.trackToAdd.album.images[0].url=i)}),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(3),t.Q6J("ngModel",e.trackToAdd.album.images[0].url)}}function z(n,s){1&n&&t._UZ(0,"ion-img",34)}function W(n,s){if(1&n&&t._UZ(0,"ion-img",35),2&n){const e=t.oxw(3);t.Q6J("src","data:image/jpeg;base64,"+e.trackToAdd.album.images[0].imageBase64String)}}function q(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",29),t.YNc(1,z,1,0,"ion-img",30),t.YNc(2,W,1,1,"ion-img",31),t.TgZ(3,"ion-fab",32)(4,"ion-fab-button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.takePicture())}),t._UZ(5,"ion-icon",33),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.trackToAdd.album.images[0].imageBase64String),t.xp6(1),t.Q6J("ngIf",e.trackToAdd.album.images[0].imageBase64String)}}function Y(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"A\xf1adir canci\xf3n"),t.qZA(),t.TgZ(4,"ion-buttons",16)(5,"ion-button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.cancel())}),t._uU(6,"Cancelar"),t.qZA(),t.TgZ(7,"ion-button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.confirm(i.trackToAdd))}),t._uU(8,"A\xf1adir"),t.qZA()()()(),t.TgZ(9,"ion-content",20)(10,"ion-item")(11,"ion-label",21),t._uU(12,"Nombre"),t.qZA(),t.TgZ(13,"ion-input",22),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.trackToAdd.name=i)}),t.qZA()(),t.TgZ(14,"ion-item")(15,"ion-label",21),t._uU(16,"Artista/Grupo"),t.qZA(),t.TgZ(17,"ion-input",23),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.trackToAdd.album.artists[0].name=i)}),t.qZA()(),t.TgZ(18,"ion-segment",13),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.togglePhoto=i)}),t.TgZ(19,"ion-segment-button",24)(20,"ion-label"),t._uU(21,"URL"),t.qZA()(),t.TgZ(22,"ion-segment-button",25)(23,"ion-label"),t._uU(24,"Imagen"),t.qZA()()(),t.YNc(25,_,4,1,"ion-item",26),t.YNc(26,q,6,2,"div",27),t.qZA()}if(2&n){const e=t.oxw();t.xp6(7),t.Q6J("strong",!0),t.xp6(6),t.Q6J("ngModel",e.trackToAdd.name),t.xp6(4),t.Q6J("ngModel",e.trackToAdd.album.artists[0].name),t.xp6(1),t.Q6J("ngModel",e.togglePhoto),t.xp6(7),t.Q6J("ngIf","url"===e.togglePhoto),t.xp6(1),t.Q6J("ngIf","img"===e.togglePhoto)}}function it(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-fab-button",42),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.insertTrack(i))}),t._UZ(1,"ion-icon",18),t.qZA()}}function K(n,s){1&n&&(t.TgZ(0,"ion-fab-button",43),t._UZ(1,"ion-icon",44),t.qZA())}function D(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-fab-list")(1,"ion-fab-button")(2,"ion-icon",45),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.navigateToTrackEdit(i._id))}),t.qZA()(),t.TgZ(3,"ion-fab-button",46),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.handleDeleteAlert(i._id))}),t._UZ(4,"ion-icon",47),t.qZA()()}}function V(n,s){if(1&n&&t._UZ(0,"ion-img",35),2&n){const e=t.oxw().$implicit;t.s9C("src",e.album.images[0].url)}}function X(n,s){if(1&n&&t._UZ(0,"ion-img",35),2&n){const e=t.oxw().$implicit;t.Q6J("src","data:image/jpeg;base64,"+e.album.images[0].imageBase64String)}}function tt(n,s){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.xp6(1),t.Oqu(e.name)}}function at(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"ion-card",36)(1,"ion-fab"),t.YNc(2,it,2,0,"ion-fab-button",37),t.YNc(3,K,2,0,"ion-fab-button",38),t.YNc(4,D,5,0,"ion-fab-list",26),t.qZA(),t.TgZ(5,"div",6),t.NdJ("click",function(){const a=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.navigateToTrack(a._id))}),t.TgZ(6,"div",39),t.YNc(7,V,1,1,"ion-img",31),t.YNc(8,X,1,1,"ion-img",31),t.qZA(),t.TgZ(9,"div",40)(10,"div")(11,"p"),t._uU(12),t.qZA()(),t.TgZ(13,"div"),t.YNc(14,tt,2,1,"p",41),t.qZA(),t.TgZ(15,"div")(16,"p"),t._uU(17),t.ALo(18,"date"),t.qZA()()()()()}if(2&n){const e=s.$implicit,r=t.oxw();t.xp6(2),t.Q6J("ngIf",r.toggleInsert&&!e.inserted),t.xp6(1),t.Q6J("ngIf",!r.toggleInsert&&r.displayInsert),t.xp6(1),t.Q6J("ngIf",!r.toggleInsert&&r.displayInsert),t.xp6(3),t.Q6J("ngIf",e.album.images[0].url),t.xp6(1),t.Q6J("ngIf",e.album.images[0].imageBase64String),t.xp6(4),t.Oqu(e.name),t.xp6(2),t.Q6J("ngForOf",e.album.artists),t.xp6(3),t.hij("",t.xi3(18,8,e.duration_ms,"mm:ss")," min")}}var c=(()=>{return(n=c||(c={})).name="name",n.artist="artist",n.date="date",c;var n})();let o=(()=>{class n{constructor(e,r,i,a,h,p){this.apiService=e,this.route=r,this.authService=i,this.router=a,this.alertCtrl=h,this.toastCtrl=p,this.toggleInsert=!1,this.displayInsert=!1,this.filter=c.name,this.searchFilters=Object.values(c),this.trackToAdd=new $("",new H("","","")),this.togglePhoto="url",this.route.queryParams.subscribe(L=>{this.displayInsert=this.authService.checkLogged(),this.query=L.s,Object.keys(c).includes(L.f)&&(this.filter=L.f),this.search()})}handleDeleteAlert(e){this.alertCtrl.create({header:"Confirmar eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que quieres eliminar esta canci\xf3n?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"confirm",handler:()=>{var r;this.deleteTrack(e),this.tracks=null===(r=this.tracks)||void 0===r?void 0:r.filter(i=>i._id!=e)}}]}).then(r=>r.present())}cancel(){this.modal&&this.modal.dismiss(null,"cancel")}confirm(e){this.modal&&this.modal.dismiss(e,"confirm")}onWillDismiss(e){const r=e;var i;console.log("Will dismiss with: ",r.detail),"confirm"===r.detail.role&&r.detail.data&&(r.detail.data._id=null===(i=r.detail.data)||void 0===i?void 0:i.name,"url"==this.togglePhoto&&(r.detail.data.album.images[0].imageBase64String=void 0),"img"==this.togglePhoto&&(r.detail.data.album.images[0].url=void 0),this.insertTrack(r.detail.data))}changeParams(){let e={s:this.query,f:this.filter};""==this.query&&(e.s=void 0),this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge"})}navigateToTrack(e){this.router.navigate([`/tracks/${e}`])}navigateToTrackEdit(e){this.router.navigate([`/tracks/${e}/edit`])}toggleInsertTrack(){this.toggleInsert=!this.toggleInsert,this.search()}search(){this.changeParams(),this.query?this.toggleInsert?this.searchSpotify(this.query):this.searchDB(this.query):this.getAllTracks()}searchSpotify(e){var r=this;return(0,l.Z)(function*(){const i=yield r.apiService.searchTracksSpotify(e),a=yield r.apiService.getTracks();for(let h of i)h.inserted=!!a.find(p=>p._id==h._id);r.tracks=i.filter(h=>0==h.inserted)})()}searchDB(e){var r=this;return(0,l.Z)(function*(){try{r.tracks=yield r.apiService.searchTracks(e,r.filter)}catch(i){i instanceof Error&&console.error(i.message)}})()}getAllTracks(){var e=this;return(0,l.Z)(function*(){try{e.tracks=yield e.apiService.getTracks()}catch(r){r instanceof Error&&console.error(r.message)}})()}insertTrack(e){var r=this;return(0,l.Z)(function*(){var i;yield r.apiService.insertTrack(e),r.tracks=null===(i=r.tracks)||void 0===i?void 0:i.filter(a=>a._id!=e._id),r.toastCtrl.create({message:"Canci\xf3n insertada correctamente",duration:2e3}).then(a=>a.present())})()}deleteTrack(e){var r=this;return(0,l.Z)(function*(){console.log("deleteTrack: "+e),(yield r.apiService.deleteTrack(e))?r.toastCtrl.create({message:"Canci\xf3n eliminada correctamente",duration:2e3}).then(a=>a.present()):r.toastCtrl.create({message:"No se ha podido eliminar la canci\xf3n",duration:2e3}).then(a=>a.present())})()}takePicture(){var e=this;return(0,l.Z)(function*(){const r=yield N.getPhoto({quality:100,allowEditing:!1,resultType:O.dk.Base64});r&&r.base64String&&(e.trackToAdd.album.images[0]={imageBase64String:r.base64String})})()}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.j),t.Y36(T.gz),t.Y36(Z.e),t.Y36(T.F0),t.Y36(m.Br),t.Y36(m.yF))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-tracks"]],viewQuery:function(e,r){if(1&e&&t.Gf(m.ki,5),2&e){let i;t.iGM(i=t.CRH())&&(r.modal=i.first)}},standalone:!0,features:[t.jDz],decls:20,vars:5,consts:[["slot","start"],["defaultHref","/"],[3,"ngModel","ngModelChange",4,"ngIf"],["slot","end",4,"ngIf"],["id","searchBar"],["mode","ios","placeholder","Introduce el nombre de la canci\xf3n",3,"ngModel","keyup.enter","ngModelChange"],[3,"click"],["slot","end","name","search"],["id","container"],["trigger","open-modal",3,"willDismiss"],[3,"fixed"],[1,"ion-justify-content-center"],["button","",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["slot","end"],["id","open-modal","size","small"],["name","add"],["color","primary",3,"strong","click"],[1,"ion-padding"],["position","stacked"],["type","text","aria-label","Nombre","placeholder","Nombre de la canci\xf3n",3,"ngModel","ngModelChange"],["type","text","aria-label","Artista","placeholder","Artista o grupo",3,"ngModel","ngModelChange"],["value","url"],["value","img"],[4,"ngIf"],["style","padding: 45px 0;",4,"ngIf"],["type","text","aria-label","URL","placeholder","URL de la imagen",3,"ngModel","ngModelChange"],[2,"padding","45px 0"],["src","../../../assets/placeholder.png",4,"ngIf"],[3,"src",4,"ngIf"],["vertical","bottom","horizontal","center","slot","fixed"],["name","camera"],["src","../../../assets/placeholder.png"],[3,"src"],["button",""],["size","small",3,"click",4,"ngIf"],["size","small","color","light",4,"ngIf"],["id","img-container"],["id","card-info"],[4,"ngFor","ngForOf"],["size","small",3,"click"],["size","small","color","light"],["name","ellipsis-vertical"],["name","pencil",3,"click"],["id","delete-alert",3,"click"],["name","trash","color","danger"]],template:function(e,r){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title"),t.YNc(5,d,2,2,"ion-segment",2),t.qZA(),t.YNc(6,g,5,1,"ion-buttons",3),t.qZA(),t.TgZ(7,"ion-toolbar")(8,"div",4)(9,"ion-searchbar",5),t.NdJ("keyup.enter",function(){return r.search()})("ngModelChange",function(a){return r.query=a}),t.qZA(),t.TgZ(10,"ion-button",6),t.NdJ("click",function(){return r.search()}),t._UZ(11,"ion-icon",7),t._uU(12," Buscar "),t.qZA()()()(),t.TgZ(13,"ion-content")(14,"div",8)(15,"ion-modal",9),t.NdJ("willDismiss",function(a){return r.onWillDismiss(a)}),t.YNc(16,Y,27,6,"ng-template"),t.qZA(),t.TgZ(17,"ion-grid",10)(18,"ion-row",11),t.YNc(19,at,19,11,"ion-card",12),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("ngIf",!r.toggleInsert),t.xp6(1),t.Q6J("ngIf",r.displayInsert),t.xp6(3),t.Q6J("ngModel",r.query),t.xp6(8),t.Q6J("fixed",!0),t.xp6(2),t.Q6J("ngForOf",r.tracks))},dependencies:[v.ez,v.sg,v.O5,v.uU,b.u5,b.JJ,b.On,m.Pc,m.oU,m.YG,m.Sm,m.PM,m.W2,m.IJ,m.W4,m.zq,m.jY,m.Gu,m.gu,m.Xz,m.pK,m.Ie,m.Q$,m.Nd,m.VI,m.cJ,m.GO,m.wd,m.sr,m.ki,m.QI,m.j9,m.cs,T.Bz],styles:['ion-card[_ngcontent-%COMP%]{width:200px;position:relative;height:300px;background-color:#000;transition:.5s}ion-card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}ion-img[_ngcontent-%COMP%]{height:100%}ion-card[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{position:absolute;z-index:1;top:0;right:0}#img-container[_ngcontent-%COMP%]{position:relative}#img-container[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;top:0;width:100%;height:100%;background:linear-gradient(to bottom,rgba(255,255,255,0) 0,black 100%)}#card-info[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}#card-info[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#000;color:#fff;text-align:center;border-radius:5px;margin:0 auto;width:max-content;padding:0 10px;max-width:80%;box-shadow:0 0 130px 30px var(--ion-color-primary)}#searchBar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:500px;margin:0 auto}#searchBar[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:0 20px}ion-segment[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin:0 auto}ion-modal[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:45%;margin:0 auto}@media (max-width: 768px){ion-modal[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:90%;margin:0 auto}}']}),n})()},721:(Q,M,u)=>{u.r(M),u.d(M,{routes:()=>v});const v=[{path:"",component:u(9425).H},{path:":id",loadComponent:()=>u.e(6845).then(u.bind(u,6845)).then(b=>b.TrackPage)},{path:":id/edit",loadComponent:()=>u.e(9077).then(u.bind(u,9077)).then(b=>b.EditPage)}]},8672:(Q,M,u)=>{u.d(M,{j:()=>t});var l=u(5861),v=u(529),b=u(9808),T=u(2340),m=u(9425),$=u(4650),H=u(7556);const O=(0,u(7423).fo)("Geolocation",{web:()=>u.e(4561).then(u.bind(u,4561)).then(y=>new y.GeolocationWeb)});let N=(()=>{class y{constructor(){this.coords={latitude:0,longitude:0,accuracy:0}}getLocation(){var f=this;return(0,l.Z)(function*(){const d=yield O.getCurrentPosition();return f.coords.latitude=d.coords.latitude,f.coords.latitude=d.coords.longitude,f.coords.accuracy=d.coords.accuracy,f.coords})()}}return y.\u0275fac=function(f){return new(f||y)},y.\u0275prov=$.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})(),t=(()=>{class y{constructor(f,d,g){this.http=f,this.authService=d,this.geoService=g,this.url=T.N.url,this.token=this.authService.getJWT()}searchTracksSpotify(f){var d=this;return(0,l.Z)(function*(){try{const g=(yield(0,b.n)(d.http.get(`${d.url}search/${encodeURI(f)}`))).tracks.items;return console.log(g),g.map(_=>({_id:_.id,..._,id:void 0}))}catch(g){return console.log(g),[]}})()}searchTracks(f,d=m.a.name){var g=this;return(0,l.Z)(function*(){try{return yield(0,b.n)(g.http.get(`${g.url}tracks/search?${d}=${encodeURI(f)}`,{headers:{Authorization:`Bearer ${g.token}`}}))}catch(_){if(_ instanceof v.UA){if(404===_.status)throw new Error("Track not found");if(500===_.status)throw new Error("Error getting track");if(0===_.status)throw new Error("Error connecting to server")}throw _}})()}getTrack(f){var d=this;return(0,l.Z)(function*(){try{return yield(0,b.n)(d.http.get(`${d.url}tracks/${f}`,{headers:{Authorization:`Bearer ${d.token}`}}))}catch(g){if(g instanceof v.UA){if(404===g.status)throw new Error("Track not found");if(500===g.status)throw new Error("Error getting track");if(0===g.status)throw new Error("Error connecting to server")}throw g}})()}getTracks(){var f=this;return(0,l.Z)(function*(){try{return yield(0,b.n)(f.http.get(`${f.url}tracks/`,{headers:{Authorization:`Bearer ${f.token}`}}))}catch(d){if(d instanceof v.UA){if(500===d.status)throw new Error("Error getting track");if(0===d.status)throw new Error("Error connecting to server")}}return[]})()}insertTrack(f){var d=this;return(0,l.Z)(function*(){const g=yield d.geoService.getLocation();f.location=g;try{return yield(0,b.n)(d.http.post(`${d.url}tracks/`,f,{headers:{Authorization:`Bearer ${d.token}`}})),!0}catch(_){if(_ instanceof v.UA&&400===_.status)throw Error("Track already exists");return!1}})()}insertComment(f,d){var g=this;return(0,l.Z)(function*(){const _=yield g.geoService.getLocation();d.location=_,console.log(d);try{return yield(0,b.n)(g.http.post(`${g.url}tracks/${f}/comments`,d,{headers:{Authorization:`Bearer ${g.token}`}})),!0}catch(z){return z instanceof v.UA&&404===z.status&&console.log("Track not found"),!1}})()}updateTrack(f){var d=this;return(0,l.Z)(function*(){try{return yield(0,b.n)(d.http.put(`${d.url}tracks/${f._id}`,f,{headers:{Authorization:`Bearer ${d.token}`}})),!0}catch(g){return g instanceof v.UA&&(404===g.status&&console.log("Track not found"),500===g.status&&console.log("Error updating track")),!1}})()}deleteTrack(f){var d=this;return(0,l.Z)(function*(){try{return yield(0,b.n)(d.http.delete(`${d.url}tracks/${f}`,{headers:{Authorization:`Bearer ${d.token}`}})),!0}catch(g){return g instanceof v.UA&&(404===g.status&&console.log("Track not found"),500===g.status&&console.log("Error deleting track")),!1}})()}getComments(f){var d=this;return(0,l.Z)(function*(){let g=[];try{g=yield(0,b.n)(d.http.get(`${d.url}tracks/${f}/comments`,{headers:{Authorization:`Bearer ${d.token}`}})),console.log(g)}catch(_){_ instanceof v.UA&&(404===_.status&&console.log("Track not found"),500===_.status&&console.log("Error getting comments"))}return g})()}deleteComment(f,d){var g=this;return(0,l.Z)(function*(){try{return yield(0,b.n)(g.http.delete(`${g.url}tracks/${f}/comments/${d}`,{headers:{Authorization:`Bearer ${g.token}`}})),!0}catch(_){return _ instanceof v.UA&&(404===_.status&&console.log("Track not found"),500===_.status&&console.log("Error deleting comment")),!1}})()}}return y.\u0275fac=function(f){return new(f||y)($.LFG(v.eN),$.LFG(H.e),$.LFG(N))},y.\u0275prov=$.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()}}]);